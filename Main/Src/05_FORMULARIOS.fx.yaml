"'05_FORMULARIOS' As screen":
    Fill: =RGBA(237, 242, 242, 1)
    OnHidden: |
        =Set(AutoSave,true);
        Set(AutoSave,false);
        
        //Set(varTimerReset,true);
        //Set(varTimerReset,false)
    OnVisible: |+
        =Set(varDeeplinkComplete,true);
        Set(AutoSave,false);
        Set(AutoSave,true);
        UpdateContext({VarPendingIndicatorTimer:false});
        UpdateContext({varBlobItems:false});
        UpdateContext({VarEdtRsonQusPos: 0,VarEdtRsonChldPos: 0,VarCommentQuesPos:0,VarCommentChildPos:0,varCameraContorls:Blank()});
        //Set(varTimerReset,true);
        //Set(varTimerReset,false);
        
        
        
        If(VarLoadPage,
        Reset(Formularios_Header_Tmr_LoadingScreen);UpdateContext({VarTimerStart: true});
        
        ClearCollect(colformAnswerAttachment,ShowColumns(Filter('dsf.form_answer_attachment',Pr_FormNumber in faa_path_vc,faa_date_vc=Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T","")),faa_path_vc,faa_sas_vc,faa_date_vc,faa_item_vc,faa_child_pos));
        UpdateContext({varResetReason:true});
        UpdateContext({varResetReason:false});
        );
        
        UpdateContext({vasStartTimerEvaluate:false});
        UpdateContext({VarEvaluateForm:false});
        If(!varStopFlag || IsBlank(varStopFlag),
        Set(
            varNextAnswer,
            1
        ));
        UpdateContext({varShowDialog: false});
        
        ClearCollect(
            collFormReq,
            Filter(
                'dsf.form_request',
                fr_planta_id_in = varPlantId,
                fr_form_number_vc = Pr_FormNumber
            )
        );
        
        UpdateContext(
            {
                varIsFormRequest: LookUp(
                    collFormReq,
                    fr_reportdate_dt = DateTimeValue(Pr_DateFilteDT)
                )
            }
        );
        Set(
            TotalPending,
            CountRows(varFormsLibraryCT)
        );
        
        
        
            Set(varStopFlag,false);
        If(AutoSaveTable,Select(btn_auto_save));
        
        
        //If(AutoSaveTable,Select(btn_auto_save));
        //Reset(Formularios_QuestionList);
        
        

    Slider1 As slider:
        Default: |
            =Max(Formularios_QuestionList.AllItems,Label15.Text)
        Height: =70
        Max: =1200
        OnChange: |-
            =If(Formularios_Loading_Cmp_Loading.IsLoading,UpdateContext({HeightCell:440}), UpdateContext({HeightCell:Self.Value}))
        Width: =131
        X: =217
        ZIndex: =1

    Formularios_QuestionList As gallery.galleryVertical:
        '#CopilotOverlayLabel': ="Filtered"
        BorderColor: =RGBA(0, 0, 0, 0)
        Default: =LookUp(coltestanswere,RowNum=varNextAnswer)
        DelayItemLoading: =true
        Height: =Formularios_Footer_Shp_Background.Y -Self.Y
        Items: |-
            =//collAnswers
            //If(App.Width<1250,collAnswers,
            /*If(('tgl_hide/unhide'.Value),
            SortByColumns(coltestanswere,"questionNumberNew",SortOrder.Ascending),
            SortByColumns(Filter(coltestanswere,IsActive=true),"questionNumberNew",SortOrder.Ascending)
            )*/
            SortByColumns(coltestanswere,"questionNumberNew",SortOrder.Ascending)
        Layout: =Layout.Vertical
        TemplateSize: =HeightCell
        Width: =Parent.Width
        WrapCount: =If(App.Width<=1229,1,App.Width<=2650,2,3)
        Y: =Formularios_Header_Shp_NavBarTop.Height
        ZIndex: =2

        HiddenHTMLQuestion As htmlViewer:
            AutoHeight: =true
            Color: |
                =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =0
            HtmlText: ="<p>"&Q99_Lbl_Question.Text&"</p>"
            OnSelect: =Select(Parent)
            Size: =Q99_Lbl_Question.Size
            Width: =Q99_Lbl_Question.Width-30
            X: =-Parent.TemplateWidth
            Y: =Q99_Lbl_Question.Y
            ZIndex: =2

        btn_launchCamera As button:
            Fill: =RGBA(26,150,148,1)
            FontWeight: =FontWeight.Normal
            Height: =70
            HoverFill: =ColorFade(RGBA(26,150,148,1), -20%)
            OnSelect: |
                =
                UpdateContext({varCameraContorls:ThisItem.fa_question_pos_in});
                UpdateContext({varCameraChild:ThisItem.fa_child_pos_in});
                
                Set(
                    varNextAnswer,
                    If(App.Width<=1229,
                    ThisItem.RowNum+1,App.Width<=2650,ThisItem.RowNum,If(Mod(ThisItem.questionNumberNew,3)=0,ThisItem.RowNum-2,Mod(ThisItem.questionNumberNew,3)=2||ThisItem.questionNumberNew=2,ThisItem.RowNum-1,ThisItem.RowNum))
                );
                Reset(Formularios_QuestionList)
            Size: =21
            Text: ="Launch Camera"
            Visible: |
                =If(
                    And(
                        Or(ThisItem.fa_active_level=Int(ThisItem.fa_user_type),Pr_ReviewMode = 1),
                        ThisItem.fa_answer_type_in = 11,
                        !varBlobItems,
                        Or(varIsFormRequest.fr_status_in <> 2,Pr_ReviewMode = 1,IsBlank(varIsFormRequest.fr_status_in))
                    ),
                    true,
                    false
                )
                
                /*If(
                    And(
                        Or(ThisItem.fq_question_type_bt = varUserEmisorReceptor,Pr_ReviewMode = 1),
                        ThisItem.fa_answer_type_in = 11,
                        !varBlobItems,
                        Or(varIsFormRequest.fr_status_in <> 2,Pr_ReviewMode = 1,IsBlank(varIsFormRequest.fr_status_in))
                    ),
                    true,
                    false
                )
                */
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =3

        Q14_QuestionAttachment As attachments:
            AddAttachmentText: =First(collAppLanguage).Q14_QuestionAttachment_03
            BorderColor: =
            DisplayMode: =Parent.DisplayMode
            Font: ="Unity"
            Height: =180
            IsInDataCard: =true
            Items: =
            MaxAttachments: =3
            MaxAttachmentSize: =25
            MaxAttachmentsText: =First(collAppLanguage).Q14_QuestionAttachment_02
            NoAttachmentsText: =First(collAppLanguage).Q14_QuestionAttachment_01
            PaddingBottom: =5
            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
            PaddingRight: =5
            PaddingTop: =5
            Size: =15
            Tooltip: =
            Visible: |-
                =If(
                    And(
                        Or(ThisItem.fa_active_level=Int(ThisItem.fa_user_type),Pr_ReviewMode = 1),
                        ThisItem.fa_answer_type_in = 14,
                        !varBlobItems,
                        Or(varIsFormRequest.fr_status_in <> 2,Pr_ReviewMode = 1, IsBlank(varIsFormRequest.fr_status_in))
                    ),
                    true,
                    false
                )
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =4

        Q12_RadioSection As radio:
            BorderColor: =RGBA(0, 0, 0, 0)
            Default: =If(!IsBlank(Find(ThisItem.fa_answer_text_vc,ThisItem.fa_answer_list_vc)),ThisItem.fa_answer_text_vc)
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                 If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
            Font: ="Unity"
            Height: =200
            HoverColor: =RGBA(149, 149, 149, 1)
            Items: |-
                =ForAll(Split(ThisItem.fa_answer_list_vc,","), {Result: ThisRecord.Value})
            Layout: =Layout.Horizontal
            OnChange: |-
                =If(ThisItem.fa_child_pos_in=0  && !varLoadingVisible,
                Patch(coltestanswere2,LookUp (coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0),{temp_answer2:Text(Self.Selected.Result)}));
                
                /*
                If(!'tgl_hide/unhide'.Value,
                ForAll(Filter(coltestanswere,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in<>0) As ChildQues ,If(Self.Selected.Result in ChildQues.fa_child_criteria,Patch(coltestanswere,ChildQues,{IsActive:true}),Patch(coltestanswere,ChildQues,{IsActive:false}))))
                
                );
                */
            RadioBorderColor: =RGBA(0, 0, 0, 1)
            RadioSelectionFill: =RGBA(59, 165, 168, 1)
            RadioSize: =50
            Size: =21
            Visible: =ThisItem.fa_answer_type_in = 12
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 60
            ZIndex: =5

        Q08_DateSection As datepicker:
            BorderColor: =RGBA(149, 149, 149, 1)
            DefaultDate: |-
                =If(
                    !IsBlank(ThisItem.fa_answer_text_vc),
                    /*DateValue(
                        ThisItem.fa_answer_text_vc,
                        Language()
                    )*/DateValue(ThisItem.fa_answer_text_vc,"en-US"),
                    /*DateValue(
                        Today(),
                        Language()
                    )*/DateValue(Today(),"en-US")
                )
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                 If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
            Font: ="Unity"
            Format: ="mm/dd/yyyy"//DateTimeFormat.ShortDate
            Height: =70
            IconBackground: =RGBA(202, 202, 202, 1)
            OnChange: =
            Size: =23
            Visible: =ThisItem.fa_answer_type_in = 8
            Width: =Q99_Lbl_Question.Width
            X: |
                =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =9

        Q07_MultipleSelectorSection As combobox:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(219, 219, 219, 1)
            ChevronHoverBackground: =RGBA(202, 202, 202, 1)
            DefaultSelectedItems: |-
                =/*If(!IsBlank(Find(ThisItem.fa_answer_text_vc,ThisItem.fa_answer_list_vc)),*/ForAll(Split(ThisItem.fa_answer_text_vc,","), {Result: ThisRecord.Value})//)
            DisplayFields: =["Result"]
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true,Debug_Lbl_Status.Text="OK"),DisplayMode.Disabled,DisplayMode.Edit)
                //If(And((ThisItem.fa_active_level <> ThisItem.fa_user_type),Debug_Lbl_Status.Text="OK"),DisplayMode.Disabled,DisplayMode.Edit)
                 If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
            Font: ="Unity"
            Height: =70
            HoverFill: =RGBA(237, 237, 237, 1)
            Items: |-
                =ForAll(Split(ThisItem.fa_answer_list_vc,","), {Result: ThisRecord.Value})
            OnChange: =
            PressedFill: =RGBA(227, 234, 243, 1)
            SearchFields: =["Result"]
            SearchItems: |-
                =Search(ForAll(Split(ThisItem.fa_answer_list_vc,","),{Result:ThisRecord.Value}),Q07_MultipleSelectorSection.SearchText,Result)
            SelectionColor: =RGBA(0, 0, 0, 1)
            SelectionFill: =RGBA(255, 255, 255, 1)
            Size: =23
            Visible: =ThisItem.fa_answer_type_in = 7
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =10

        Q06_SelectorSection As combobox:
            BorderColor: =RGBA(166, 166, 166, 1)
            ChevronBackground: =RGBA(219, 219, 219, 1)
            ChevronHoverBackground: =RGBA(202, 202, 202, 1)
            DefaultSelectedItems: |-
                =If(!IsBlank(Find(ThisItem.fa_answer_text_vc,ThisItem.fa_answer_list_vc)),ForAll(Split(ThisItem.fa_answer_text_vc,","), {Result: ThisRecord.Value}))
            DisplayFields: =["Result"]
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                 If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
            Font: ="Unity"
            Height: =70
            HoverFill: =RGBA(237, 237, 237, 1)
            Items: |-
                =ForAll(Split(ThisItem.fa_answer_list_vc,","), {Result: ThisRecord.Value})
            OnChange: |-
                =If(ThisItem.fa_child_pos_in=0,
                Patch(coltestanswere2,LookUp (coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0),{temp_answer2:(Q06_SelectorSection.Selected.Result)}));
                
                /*If(!'tgl_hide/unhide'.Value,
                ForAll(Filter(coltestanswere,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in<>0) As ChildQues ,If(Q06_SelectorSection.Selected.Result in ChildQues.fa_child_criteria,Patch(coltestanswere,ChildQues,{IsActive:true}),Patch(coltestanswere,ChildQues,{IsActive:false}))))
                
                );
                */
            PressedFill: =RGBA(227, 234, 243, 1)
            SearchFields: =["Result"]
            SearchItems: |-
                =Search(ForAll(Split(ThisItem.fa_answer_list_vc,","),{Result:ThisRecord.Value}),Q06_SelectorSection.SearchText,Result)
            SelectionColor: =RGBA(0, 0, 0, 1)
            SelectionFill: =RGBA(255, 255, 255, 1)
            SelectMultiple: =false
            Size: =23
            Visible: =ThisItem.fa_answer_type_in = 6
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =11

        Q02_NumericSection As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            Q02_Txt_NumericInput As text:
                Align: =Align.Right
                BorderColor: =RGBA(149, 149, 149, 1)
                Default: =If(!IsBlank(ThisItem.fa_answer_numeric_in),ThisItem.fa_answer_numeric_in)
                DisabledColor: =RGBA(149, 149, 149, 1)
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Fill: |-
                    =If(Q02_Txt_NumericInput.Text="-",RGBA(232, 193, 77, 1),
                        Value(
                            If(
                                IsBlank(Q02_Txt_NumericInput.Text),
                                0,
                                Q02_Txt_NumericInput.Text
                            )
                        ) > ThisItem.fa_answer_max_dc Or Value(
                            If(
                                IsBlank(Q02_Txt_NumericInput.Text),
                                0,
                                Q02_Txt_NumericInput.Text
                            )
                        ) < ThisItem.fa_answer_min_dc,
                        RGBA(232, 193, 77, 1),
                        RGBA(255, 255, 255, 1)
                    )
                Font: ="Unity"
                Format: =TextFormat.Number
                Height: =70
                HintText: =""
                HoverBorderColor: =RGBA(149, 149, 149, 1)
                HoverFill: =RGBA(244, 244, 244, 1)
                MaxLength: =10
                OnChange: |-
                    =If(ThisItem.fa_child_pos_in=0 && !IsBlank(Value(Self.Text)) &&!varLoadingVisible,
                    Patch(coltestanswere2,LookUp (coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0),{temp_answer2:If( Value(Self.Text)<=Value(ThisItem.fa_answer_max_dc) && Value(Self.Text)>= Value(ThisItem.fa_answer_min_dc),"Within Range","Out of Range")
                    
                    }));
                    /*
                    If(!'tgl_hide/unhide'.Value,
                    ForAll(Filter(coltestanswere,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in<>0) As ChildQues ,If(If( Value(Self.Text)<=Value(ThisItem.fa_answer_max_dc) && Value(Self.Text)>= Value(ThisItem.fa_answer_min_dc),"Within Range","Out of Range") in ChildQues.fa_child_criteria,Patch(coltestanswere,ChildQues,{IsActive:true}),Patch(coltestanswere,ChildQues,{IsActive:false}))))
                    
                    );
                    
                    */
                OnSelect: =//Collect(VarLabelPictureTest, Gallery9.AllItems)
                Size: =23
                Visible: =ThisItem.fa_answer_type_in = 2
                Width: =Q99_Lbl_Question.Width
                X: =Q99_Lbl_Question.X
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =19

            Q02_Lbl_Range As label:
                Align: =Align.Right
                DisplayMode: |-
                    =//If(ThisItem.fq_question_type_bt = 0 & varUserEmisorReceptor = true,DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =41
                Size: =20
                Text: =First(collAppLanguage).Label4_14 & " " & ThisItem.fa_answer_min_dc & "-" & ThisItem.fa_answer_max_dc
                Visible: =ThisItem.fa_answer_type_in = 2
                Width: =Q99_Lbl_Question.Width
                X: =Q99_Lbl_Question.X + Q99_Lbl_Question.Width - Self.Width
                Y: =Q02_Txt_NumericInput.Y + Q02_Txt_NumericInput.Height + 5
                ZIndex: =20

            Q02_Icon_Check As icon.Add:
                Color: =RGBA(0, 0, 0, 1)
                DisplayMode: |-
                    =If((ThisItem.fa_active_level <> Int(ThisItem.fa_user_type)),DisplayMode.Disabled,DisplayMode.Edit)
                    //If(ThisItem.fq_question_type_bt = 0 & varUserEmisorReceptor = true,DisplayMode.Disabled,DisplayMode.Edit)
                Height: =32
                Icon: |-
                    =If(
                        Value(
                            If(
                                IsBlank(Q02_Txt_NumericInput.Text),
                                0,
                                Q02_Txt_NumericInput.Text
                            )
                        ) > ThisItem.fa_answer_max_dc Or Value(
                            If(
                                IsBlank(Q02_Txt_NumericInput.Text),
                                0,
                                Q02_Txt_NumericInput.Text
                            )
                        ) < ThisItem.fa_answer_min_dc,
                        Icon.Cancel,
                        Icon.Check
                    )
                Visible: =ThisItem.fa_answer_type_in = 2
                Width: =25
                X: =Q99_Lbl_Question.X + 10
                Y: =Q02_Txt_NumericInput.Y + Q02_Txt_NumericInput.Height/2 - Self.Height/2
                ZIndex: =21

        Q03_TextSection As text:
            BorderColor: =RGBA(153, 207, 236, 1)
            Clear: =true
            Default: |
                =If(!IsBlank(ThisItem.fa_answer_text_vc),ThisItem.fa_answer_text_vc)
            DisabledColor: =RGBA(0, 0, 0, 1)
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true,Debug_Lbl_Status.Text="OK"),DisplayMode.Disabled,DisplayMode.Edit)
                //If(And(ThisItem.fa_active_level<>ThisItem.fa_user_type,Debug_Lbl_Status.Text="OK"),DisplayMode.Disabled,DisplayMode.Edit)
                If((And(Pr_ReviewMode = 1, Int(ThisItem.fa_answer_type_in) <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,And(ThisItem.fa_active_level<>Int(ThisItem.fa_user_type),Debug_Lbl_Status.Text="OK"),DisplayMode.Disabled,DisplayMode.Edit)
                 
            Font: ="Unity"
            Height: =174
            HintText: =""
            HoverBorderColor: =RGBA(149, 149, 149, 1)
            HoverFill: =RGBA(244, 244, 244, 1)
            MaxLength: =ThisItem.fa_answer_characters_in
            Mode: =TextMode.MultiLine
            OnChange: =
            PressedColor: =RGBA(0, 0, 0, 1)
            Size: =23
            Visible: =ThisItem.fa_answer_type_in = 3
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 30
            ZIndex: =17

        Q01_YesNoSection As toggleSwitch:
            BorderColor: =RGBA(0, 0, 0, 0)
            Default: =If(ThisItem.fa_answer_bit_bt = true, ThisItem.fa_answer_bit_bt, false)
            DisabledBorderColor: =RGBA(168, 0, 0, 1)
            DisplayMode: |-
                = If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                //If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
            FalseFill: =RGBA(166, 166, 166, 1)
            FalseText: =ThisItem.fa_label_off_vc
            Font: ="Unity"
            Height: =55
            OnChange: |-
                =If(ThisItem.fa_child_pos_in=0,
                Patch(coltestanswere2,LookUp (coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0),{temp_answer2:Text(Self.Value)}));
                /*If(!'tgl_hide/unhide'.Value,
                ForAll(Filter(coltestanswere,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in<>0) As ChildQues ,If(Text(Self.Value) in ChildQues.fa_child_criteria,Patch(coltestanswere,ChildQues,{IsActive:true}),Patch(coltestanswere,ChildQues,{IsActive:false})))))*/
            Size: =23
            TextPosition: =TextPosition.Left
            TrueFill: =RGBA(136, 160, 209, 1)
            TrueText: =ThisItem.fa_label_on_vc
            Visible: =ThisItem.fa_answer_type_in = 1
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =22

        Q04_BarcodeSection As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =25

            Q04_Icon_Barcode As icon.Add:
                Color: =RGBA(149, 149, 149, 1)
                DisabledColor: =RGBA(0, 0, 0, 0.6)
                DisplayMode: |-
                    =//If(ThisItem.fq_question_type_bt = 0 & varUserEmisorReceptor = true,DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                    If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                     
                Icon: =Icon.Camera
                Visible: =ThisItem.fa_answer_type_in = 4
                X: =Q99_Lbl_Question.X + Q99_Lbl_Question.Width - Self.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =12

            Q04_Txt_Text As text:
                BorderColor: =RGBA(149, 149, 149, 1)
                Clear: =true
                Default: =If(!IsBlank(ThisItem.fa_answer_text_vc), ThisItem.fa_answer_text_vc,Q04_Btn_Barcode.Value)
                DisabledColor: =RGBA(0, 0, 0, 1)
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =111
                HintText: =//First(collAppLanguage).Txt_EscanerLectura_4
                HoverBorderColor: =RGBA(149, 149, 149, 1)
                HoverFill: =RGBA(244, 244, 244, 1)
                Mode: =TextMode.MultiLine
                OnChange: =
                PressedColor: =RGBA(0, 0, 0, 1)
                Size: =23
                Visible: =ThisItem.fa_answer_type_in = 4
                Width: =Q99_Lbl_Question.Width - Q04_Btn_Barcode.Width
                X: =Q04_Btn_Barcode.X - Self.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =16

            Q04_Btn_Barcode As barcodeScanner:
                DisabledBorderColor: |-
                    =//RGBA(166, 166, 166, 1)
                    Color.Transparent
                DisabledFill: =Color.Transparent
                DisplayMode: |-
                    =//If(ThisItem.fq_question_type_bt = 0 & varUserEmisorReceptor = true,DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                    If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                     
                Fill: =RGBA(0, 0, 0, 0)
                Height: =70
                HoverFill: =
                OnScan: |-
                    =If(
                        varLoadingVisible = false And ((varIsFormRequest.fr_status_in = 1 And ThisItem.fq_question_type_bt = true) Or IsBlank(varIsFormRequest)),
                        fa_AnswerReport.Run(
                            ThisItem.fa_answer_list_vc,
                            Q04_Txt_Text.Text,
                            User().Email,
                            "Update",
                            ThisItem.fa_form_number_vc,
                            ThisItem.fa_label_off_vc,
                            ThisItem.fa_label_on_vc,
                            ThisItem.fa_question_description_vc,
                            ThisItem.fa_title_description_vc,
                            ThisItem.fa_title_name_vc,
                            Pr_DateFilteDT,
                            Q99_Txt_Notes.Text,
                            Q01_YesNoSection.Value,
                            ThisItem.fa_answer_characters_in,
                            ThisItem.fa_answer_max_dc,
                            ThisItem.fa_answer_min_dc,
                            Q05_Slr_Slider.Value,
                            ThisItem.fa_answer_type_in,
                            0,
                            varPlantId,
                            1,
                            ThisItem.fa_question_pos_in,
                            ThisItem.fa_question_required_bt,
                            ThisItem.fa_title_hide_bt,
                            Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),ThisItem.fa_active_level)
                    );
                    
                    //If(varMaxCollAnswer > Gallery9.Selected.RowNum, Set(varNextAnswer,Gallery9.Selected.RowNum+1 ));
                Size: =24
                Text: =""
                Visible: =ThisItem.fa_answer_type_in = 4
                Width: =90
                X: =Q99_Lbl_Question.X + Q99_Lbl_Question.Width - Self.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =18

        Q05_SliderSection As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =28

            Q05_Lbl_Range As label:
                Align: =Align.Right
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =41
                Size: =21
                Text: =First(collAppLanguage).Label4_14 & " " & ThisItem.fa_answer_min_dc & "-" & ThisItem.fa_answer_max_dc
                Visible: =ThisItem.fa_answer_type_in = 5
                Width: =Q99_Lbl_Question.Width/2
                X: =Q05_Slr_Slider.X + Q05_Slr_Slider.Width - Q05_Lbl_Range.Width
                Y: =Q05_Slr_Slider.Y + Q05_Slr_Slider.Height + 10
                ZIndex: =13

            Q05_Lbl_CurrentValue As label:
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =41
                Size: =21
                Text: =Q05_Slr_Slider.Value
                Visible: =ThisItem.fa_answer_type_in = 5
                Width: =Q99_Lbl_Question.Width/2
                X: =Q05_Slr_Slider.X
                Y: =Q05_Slr_Slider.Y + Q05_Slr_Slider.Height + 10
                ZIndex: =14

            Q05_Slr_Slider As slider:
                BorderColor: =RGBA(0, 0, 0, 0)
                Default: =If(!IsBlank(ThisItem.fa_answer_numeric_in),ThisItem.fa_answer_numeric_in, ThisItem.fa_answer_min_dc)
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Height: =70
                Max: =ThisItem.fa_answer_max_dc
                Min: =ThisItem.fa_answer_min_dc
                OnChange: =
                ValueFill: =RGBA(219, 219, 219, 1)
                Visible: =ThisItem.fa_answer_type_in = 5
                Width: =Q99_Lbl_Question.Width
                X: =Q99_Lbl_Question.X
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =15

        AnsPos As label:
            Color: =RGBA(0, 13, 75, 1)
            Font: ="Unity"
            Height: =27
            OnSelect: =Select(Parent)
            Size: =18
            Text: =ThisItem.fa_question_pos_in
            Visible: =false
            Width: =100
            Wrap: =false
            X: =530
            Y: =134
            ZIndex: =29

        Ans_Type As label:
            Height: =70
            OnSelect: =Select(Parent)
            Size: =21
            Text: =ThisItem.fa_answer_type_in
            Visible: =false
            Width: =90
            X: =535
            Y: =119
            ZIndex: =30

        Q09_TimeSection As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =36

            Q09_Cb_Hour As combobox:
                BorderColor: =RGBA(166, 166, 166, 1)
                ChevronBackground: =RGBA(219, 219, 219, 1)
                ChevronHoverBackground: =RGBA(202, 202, 202, 1)
                DefaultSelectedItems: |-
                    =If(
                        !IsBlank(ThisItem.fa_answer_text_vc),
                        {Value: Hour(TimeValue(ThisItem.fa_answer_text_vc))},
                        {Value: Hour(Now())}
                    )
                DisplayFields: =["Value"]
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =70
                HoverFill: =RGBA(237, 237, 237, 1)
                InputTextPlaceholder: =
                Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                OnChange: =
                PressedFill: =RGBA(227, 234, 243, 1)
                SearchFields: =["Value"]
                SearchItems: =Search(["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],Q09_Cb_Hour.SearchText,Value)
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(255, 255, 255, 1)
                SelectMultiple: =false
                Size: =23
                Visible: =ThisItem.fa_answer_type_in = 9
                Width: =Q99_Lbl_Question.Width/2 - 7.5
                X: =Q99_Lbl_Question.X
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =6

            Q09_Cb_Minute As combobox:
                BorderColor: =RGBA(166, 166, 166, 1)
                ChevronBackground: =RGBA(219, 219, 219, 1)
                ChevronHoverBackground: =RGBA(202, 202, 202, 1)
                DefaultSelectedItems: |-
                    =If(
                        !IsBlank(ThisItem.fa_answer_text_vc),
                        {Value: Minute(TimeValue(ThisItem.fa_answer_text_vc))},
                        {Value: Minute(Now())}
                    )
                DisplayFields: =["Value"]
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If((ThisItem.fa_active_level <> ThisItem.fa_user_type),DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
                Font: ="Unity"
                Height: =70
                HoverFill: =RGBA(237, 237, 237, 1)
                InputTextPlaceholder: =
                Items: =["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                OnChange: =
                PressedFill: =RGBA(227, 234, 243, 1)
                SearchFields: =["Value"]
                SearchItems: =Search(["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],Q09_Cb_Minute.SearchText,Value)
                SelectionColor: =RGBA(0, 0, 0, 1)
                SelectionFill: =RGBA(255, 255, 255, 1)
                SelectMultiple: =false
                Size: =23
                Visible: =ThisItem.fa_answer_type_in = 9
                Width: =Q99_Lbl_Question.Width/2 - 7.5
                X: =Q99_Lbl_Question.X + Q99_Lbl_Question.Width - Self.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =7

            Q09_Lbl_Separator As label:
                Align: =Align.Center
                Font: ="Unity"
                Height: =70
                OnSelect: =Select(Parent)
                Size: =23
                Text: |-
                    =":"
                Visible: =ThisItem.fa_answer_type_in = 9
                Width: =15
                X: =Q09_Cb_Hour.X + Q09_Cb_Hour.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
                ZIndex: =8

        Q99_Lbl_Question_1 As label:
            Align: =Align.Right
            Color: |-
                =If(
                    And(
                        VarBlink,
                        VarPendingIndicatorTimer,
                        Debug_Lbl_Status.Text <> "OK"
                    )
                    ,
                    RGBA(
                        209,
                        105,
                        106,
                        1
                    ),
                    RGBA(
                        0,
                        0,
                        0,
                        1
                    )
                )
                /*If(
                    And(
                        !ThisItem.fq_question_type_bt,
                        varUserEmisorReceptor,
                        VarBlink,
                        VarPendingIndicatorTimer
                    ),
                    If(
                        Debug_Lbl_Status.Text = "OK",
                        RGBA(
                            0,
                            0,
                            0,
                            1
                        ),
                        RGBA(
                            209,
                            105,
                            106,
                            1
                        )
                    ),
                    RGBA(
                        0,
                        0,
                        0,
                        1
                    )
                )*/
                //If(VarBlink && VarPendingIndicatorTimer, RGBA(227, 234, 243, 1),RGBA(26, 150, 148, 1))
                //If(ThisItem.fa_answer_type_in <> 0, RGBA(0, 0, 0, 1), RGBA(255, 255, 255, 1))
            DisplayMode: =Q99_Icon_Edit.DisplayMode
            FontWeight: =FontWeight.Bold
            Height: =24
            Text: =If(Len(Trim(Q99_Txt_EditReason.Text)) < 10, " ", "Done!")
            Visible: =ThisItem.fa_answer_type_in <> 0 And Len(Trim(Q99_Txt_EditReason.Text)) >= 10
            Width: =145
            Wrap: =false
            X: =Q99_Icon_Edit.X - Self.Width - 10
            Y: =Q99_Icon_Edit.Y
            ZIndex: =38

        Q99_Lbl_UserIndicator As label:
            Font: ="Unity"
            FontWeight: =FontWeight.Semibold
            Height: =25
            OnSelect: =Select(Parent)
            Size: =10
            Text: |-
                =//If(ThisItem.fq_question_type_bt, "User 02", "User 01")
                 "User "&ThisItem.fa_user_type
            Visible: =And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)
            Width: =71
            X: =Q99_Icon_Notes.X + Q99_Icon_Notes.Width + 10
            Y: =Q99_Icon_Notes.Y + Q99_Icon_Notes.Height/2 - Self.Height/2
            ZIndex: =39

        Q15_Signature_PenInput As inkControl:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Dotted
            BorderThickness: =1
            Color: =RGBA(56, 96, 178, 1)
            Height: =320
            OnSelect: |-
                =//UpdateIf(ColSignatures,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=ThisItem.fa_child_pos_in,{InitialImage:Self.Image});
                UpdateIf(ColSignaturesStatus,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=ThisItem.fa_child_pos_in,{hasSigned:true})
            ShowControls: =false
            Size: =3
            Visible: |-
                =If(
                    And(
                        Or(ThisItem.fa_active_level=Int(ThisItem.fa_user_type),Pr_ReviewMode = 1),
                        ThisItem.fa_answer_type_in = 15,
                        !varBlobItems,
                        Or(varIsFormRequest.fr_status_in <> 2,Pr_ReviewMode = 1, IsBlank(varIsFormRequest.fr_status_in))
                    ),
                    true,
                    false
                )
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 70
            ZIndex: =41

        Icon2 As icon.Cancel:
            Color: =RGBA(246, 88, 16, 1)
            Height: =40
            Icon: =Icon.CancelBadge
            OnSelect: |
                =
                Reset(Q15_Signature_PenInput);
                UpdateIf(ColSignaturesStatus,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=ThisItem.fa_child_pos_in,{hasSigned:false})
            Visible: |-
                =If(
                    And(
                        Or(ThisItem.fa_active_level=Int(ThisItem.fa_user_type),Pr_ReviewMode = 1),
                        ThisItem.fa_answer_type_in = 15,
                        !varBlobItems,
                        Or(varIsFormRequest.fr_status_in <> 2,Pr_ReviewMode = 1, IsBlank(varIsFormRequest.fr_status_in))
                    ),
                    true,
                    false
                )
            Width: =40
            X: =Q15_Signature_PenInput.X+Q15_Signature_PenInput.Width-Self.Width-10
            Y: =Q15_Signature_PenInput.Y+10
            ZIndex: =42

        Q99_Shp_EditBackground As htmlViewer:
            Fill: =RGBA(0,0,0,0)
            Height: =Formularios_QuestionList.TemplateHeight
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 18 & "px;height:" & Self.Height - 32 & "px;opacity:0.5;background-color:#FFFFFF;box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
            Visible: |
                =If(Pr_ReviewMode=1,false,
                ((ThisItem.fa_answer_type_in <> 0 And !IsBlank(ThisItem.fat_question_pos_in) And Len(Trim(Q99_Txt_EditReason.Text)) < 10) || !(ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";")) && Pr_ReviewMode <> 1)  Or (varCompleteReader And ThisItem.fa_answer_type_in <> 0) || 
                !Boolean(lbl_child_enable_disable.Text)),true,false)
                /*
                (If(ThisItem.fa_child_pos_in=0,false,Not(With({parentTempAns:LookUp(coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0).temp_answer},If(!IsBlank(parentTempAns) && parentTempAns in Trim(Text(ThisItem.fa_child_criteria)),true,false)))))
                ==============================================================================================================================
                
                (ThisItem.fa_answer_type_in <> 0 And !IsBlank(ThisItem.fat_question_pos_in) And Len(Q99_Txt_EditReason.Text) < 10 ) And (If(!IsBlank(ThisItem.fa_user_type),ThisItem.fa_active_level>ThisItem.fa_user_type,true) ) Or (varCompleteReader And ThisItem.fa_answer_type_in <> 0)
                (ThisItem.fa_answer_type_in <> 0 And !IsBlank(ThisItem.fat_question_pos_in) And Len(Q99_Txt_EditReason.Text) < 10 ) Or (varCompleteReader And ThisItem.fa_answer_type_in <> 0) //Or Trim(Q99_Txt_EditReason.Text)
                 */
            Width: =Formularios_QuestionList.TemplateWidth-10
            ZIndex: =43

        Q13_TableSection As button:
            Fill: |-
                =If( (And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)), RGBA(
                        26,
                        150,
                        148,
                        1
                    ),
                    Or( (!Boolean(lbl_child_enable_disable.Text)),
                        varIsFormRequest.fr_status_in = 2
                    ),
                    RGBA(
                        186,
                        189,
                        194,
                        1
                    ),
                    RGBA(
                        26,
                        150,
                        148,
                        1
                    )
                )
                
                /*If( (And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)), RGBA(
                        26,
                        150,
                        148,
                        1
                    ),
                    Or( (!Boolean(lbl_child_enable_disable.Text)),
                        (
                                ThisItem.fa_active_level <> ThisItem.fa_user_type
                            ),
                        varIsFormRequest.fr_status_in = 2,
                        !IsBlank(ThisItem.fat_question_pos_in) And ThisItem.fa_user_type = varActiveLevel And !varCompleteReader And Len(Trim(Q99_Txt_EditReason.Text)) < 10 
                    ),
                    RGBA(
                        186,
                        189,
                        194,
                        1
                    ),
                    RGBA(
                        26,
                        150,
                        148,
                        1
                    )
                )
                */
            Font: ="Unity"
            FontWeight: =FontWeight.Normal
            Height: =70
            HoverFill: =RGBA(167, 182, 203, 1)
            OnSelect: |-
                =Set(AutoSave,true);
                Set(AutoSave,false);
                //Set(varTimerReset,true);
                //Set(varTimerReset,false);
                Set(
                    varLoadingTable,
                    true
                );
                //Set(varStart,true);
                //Set(varStart,false);
                Navigate(
                    '06_TABLE VIEWER',
                    ScreenTransition.Fade,
                    {
                        varActiveLevel: ThisItem.fa_active_level,
                        varItem:ThisItem,
                        ParamTableStructure: ThisItem.fa_title_description_vc,
                        ParamAnsPos: ThisItem.fa_question_pos_in,
                        ParamChildPos:ThisItem.fa_child_pos_in,
                        ParamReportDate: Pr_DateFilterIn,
                        ParamStructureString: If(
                            
                                !(ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";")))
                            ,
                            ThisItem.fa_answer_text_vc,
                            First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ChildPos=ThisItem.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado
                        ),
                        ParamEnable: If(
                            Or( (!Boolean(lbl_child_enable_disable.Text)),
                                 
                                !(ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";")))
                            ,
                                varIsFormRequest.fr_status_in = 2,
                                !IsBlank(ThisItem.fat_question_pos_in) And (ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";"))) And !varCompleteReader And Len(Trim(Q99_Txt_EditReason.Text)) < 10
                            ),
                            0,
                            1
                        )
                    }
                );
                
                /*
                Navigate(
                    '06_TABLE VIEWER',
                    ScreenTransition.Fade,
                    {
                        ParamTableStructure: ThisItem.fa_title_description_vc,
                        ParamAnsPos: ThisItem.fa_question_pos_in,
                        ParamReportDate: Pr_DateFilterIn,
                        ParamStructureString: If(
                            And(
                                ThisItem.fq_question_type_bt = false,
                                varUserEmisorReceptor = true
                            ),
                            ThisItem.fa_answer_text_vc,
                            First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado
                        ),
                        ParamEnable: If(
                            Or(
                                And(
                                    ThisItem.fq_question_type_bt = false,
                                    varUserEmisorReceptor = true
                                ),
                                varIsFormRequest.fr_status_in = 2,
                                !IsBlank(ThisItem.fat_question_pos_in) And ThisItem.fa_user_type = varActiveLevel And !varCompleteReader And Len(Trim(Q99_Txt_EditReason.Text)) < 10
                            ),
                            0,
                            1
                        )
                    }
                )*/
            Size: =21
            Text: =First(collAppLanguage).Q13_TableSection
            Visible: =ThisItem.fa_answer_type_in = 13
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =44

        Q11_14_TableItems As gallery.galleryVertical:
            '#CopilotOverlayLabel': ="Filtered"
            BorderColor: =RGBA(26, 150, 148, 1)
            BorderThickness: =1
            Fill: =RGBA(26, 150, 148, 0.08)
            Height: =190
            Items: |
                =Filter(colformAnswerAttachment,Pr_FormNumber in faa_path_vc,faa_date_vc=Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T",""),faa_item_vc=AnsPos.Text&&faa_child_pos=ThisItem.fa_child_pos_in)
                /*Filter(AzureBlobStorage.ListFolderV2(BlobIdGemba).value, Pr_FormNumber & "" & Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T","") & "" & AnsPos.Text & "" in Path)*/
                /*Filter(colPhotoxxx,Pr_FormNumber & "" & Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T","") & "" & AnsPos.Text & "" in Path)*/
            Layout: =Layout.Vertical
            TemplateSize: =37
            Visible: |-
                =If(
                    And(
                        Or(
                            And(
                                Int(ThisItem.fa_user_type)<=ThisItem.fa_active_level,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11,
                                    ThisItem.fa_answer_type_in = 15
                
                                )
                            ),
                            And(
                                varBlobItems,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11,
                                    ThisItem.fa_answer_type_in = 15
                                )
                            ),
                            And(
                                varIsFormRequest.fr_status_in = 2,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11,
                                    ThisItem.fa_answer_type_in = 15
                                )
                            ),
                            And(
                                Pr_ReviewMode = 1 ,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11,
                                    ThisItem.fa_answer_type_in = 15
                                )
                            )
                        ),
                        Or(varBlobItems, varIsFormRequest.fr_status_in = 2, ThisItem.fa_active_level <> Int(ThisItem.fa_user_type) &&  Pr_ReviewMode <> 1 )
                    ),
                    true,
                    false
                )
                /*If(
                    And(
                        Or(
                            And(
                                !ThisItem.fq_question_type_bt = varUserEmisorReceptor,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11
                                )
                            ),
                            And(
                                varBlobItems,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11
                                )
                            ),
                            And(
                                varIsFormRequest.fr_status_in = 2,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11
                                )
                            ),
                            And(
                                Pr_ReviewMode = 1,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11
                                )
                            )
                        ),
                        Or(varBlobItems, varIsFormRequest.fr_status_in = 2, !ThisItem.fq_question_type_bt = varUserEmisorReceptor)
                    ),
                    true,
                    false
                )*/
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 90
            ZIndex: =45

            Label1_1 As label:
                Color: =RGBA(0, 118, 245, 1)
                Font: ="Unity"
                Height: =29
                OnSelect: |-
                    =Launch(ThisItem.faa_path_vc)
                    //UpdateContext({varUrl:Text(AzureBlobStorage.CreateShareLinkByPath(BlobUrl & ThisItem.Path).WebUrl)});;
                    //Launch(AzureBlobStorage.CreateShareLinkByPath(/*BlobUrl &*/ ThisItem.Path).WebUrl)//Launch(BlobUrl & ThisItem.Path)
                Size: =15
                Text: |-
                    =Substitute(Mid(ThisItem.faa_sas_vc,
                    Find("DOC",ThisItem.faa_sas_vc)),"%C5%92","")
                    
                    /*Mid(ThisItem.DisplayName,
                    Find("",ThisItem.DisplayName,
                    Find("",ThisItem.DisplayName,
                    Find("",ThisItem.DisplayName) + 1)+1)+1,
                    Len(ThisItem.DisplayName) - 
                    Find("",ThisItem.DisplayName,
                    Find("",ThisItem.DisplayName,
                    Find("",ThisItem.DisplayName) + 1)+1))/*ThisItem.Path*/
                Underline: =true
                Width: =Q11_14_TableItems.TemplateWidth
                Wrap: =false
                ZIndex: =1

        "Q11_14_Icon_Switch As icon.'3DPrinting'":
            Color: =RGBA(255, 191, 0, 1)
            Fill: =RGBA(210, 211, 214, 0.09)
            Icon: =Icon.Link
            OnSelect: |-
                =If(varBlobItems, UpdateContext({varBlobItems:false}), UpdateContext({varBlobItems:true}))
            Visible: |-
                =
                Or(
                    And(
                        Int(ThisItem.fa_user_type)>=ThisItem.fa_active_level,
                        Or(
                            ThisItem.fa_answer_type_in = 14,
                            ThisItem.fa_answer_type_in = 11,
                            ThisItem.fa_answer_type_in = 15
                        ),
                        !IsBlank(ThisItem.fat_question_pos_in),
                        varIsFormRequest.fr_status_in <> 2
                    ),
                    And(
                        Pr_ReviewMode = 1,
                        Or(
                            ThisItem.fa_answer_type_in = 14,
                            ThisItem.fa_answer_type_in = 11,
                            ThisItem.fa_answer_type_in = 15
                        )
                    )
                )
                /*Or(
                    And(
                        ThisItem.fq_question_type_bt = varUserEmisorReceptor,
                        Or(
                            ThisItem.fa_answer_type_in = 14,
                            ThisItem.fa_answer_type_in = 11
                        ),
                        !IsBlank(ThisItem.fat_question_pos_in),
                        varIsFormRequest.fr_status_in <> 2
                    ),
                    And(
                        Pr_ReviewMode = 1,
                        Or(
                            ThisItem.fa_answer_type_in = 14,
                            ThisItem.fa_answer_type_in = 11
                        )
                    )
                )*/
            X: =Q99_Lbl_Question.X+Q99_Lbl_Question.Width-Self.Width
            Y: =Q99_Lbl_Question.Y+Q99_Lbl_Question.Height
            ZIndex: =46

        Label14 As label:
            Align: =Align.Center
            Color: |-
                =ColorValue("#3BA5A8")
            FontWeight: =FontWeight.Semibold
            Height: =55
            OnSelect: =Select(Parent)
            Size: =16
            Text: ="Click below to capture "
            Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
            Width: =Q11_QuestionCamera_Camera.Width
            X: =Q11_QuestionCamera_Camera.X
            Y: =Q11_QuestionCamera_Camera.Y-Self.Height-5
            ZIndex: =47

        Q99_Txt_EditReason As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =1
            Default: =
            DisabledFill: =RGBA(255, 255, 255, 1)
            DisplayMode: |-
                =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                //If(ThisItem.fa_active_level=ThisItem.fa_user_type,DisplayMode.Edit,DisplayMode.Disabled)
                 If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type))||(And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum)),DisplayMode.Edit,DisplayMode.Disabled)
            Fill: |
                =RGBA(255, 255, 255, 1)
            Font: ="Unity"
            FontWeight: =FontWeight.Lighter
            Height: =Q99_Icon_Notes.Y - Self.Y - 5
            HintText: ="..."
            HoverBorderColor: =RGBA(116, 116, 116, 1)
            HoverFill: =RGBA(255, 255, 255, 1)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            OnChange: |
                =If(
                    varSingleValidation = 1 And varLoadingVisible = false And ((varIsFormRequest.fr_status_in = 1 And ThisItem.fq_question_type_bt = true) Or IsBlank(varIsFormRequest)) And VarCommentQuesPos = ThisItem.fa_question_pos_in And VarCommentChildPos=ThisItem.fa_child_pos_in,
                    fa_AnswerReport.Run(
                        ThisItem.fa_answer_list_vc,
                        Switch(
                            ThisItem.fa_answer_type_in,
                            6,
                            If(
                                IsBlank(Q06_SelectorSection.Selected.Result),
                                "",
                                Q06_SelectorSection.Selected.Result
                            ),
                            12,
                            If(
                                IsBlank(Q12_RadioSection.Selected.Result),
                                "",
                                Q12_RadioSection.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BResult'
                            ),
                            3,
                            Q03_TextSection.Text,
                            4,
                            Q04_Txt_Text.Text,
                            7,
                            If(
                                IsBlank(Q07_MultipleSelectorSection.Selected.Result),
                                "",
                                Q07_MultipleSelectorSection.Selected.Result
                            ),
                            8,
                            Q08_DateSection.SelectedDate,""
                        ),
                        User().Email,
                        "Update",
                        ThisItem.fa_form_number_vc,
                        ThisItem.fa_label_off_vc,
                        ThisItem.fa_label_on_vc,
                        ThisItem.fa_question_description_vc,
                        ThisItem.fa_title_description_vc,
                        ThisItem.fa_title_name_vc,
                        Pr_DateFilteDT,
                        Q99_Txt_EditReason.Text,
                        Q01_YesNoSection.Value,
                        ThisItem.fa_answer_characters_in,
                        ThisItem.fa_answer_max_dc,
                        ThisItem.fa_answer_min_dc,
                        Switch(
                            ThisItem.fa_answer_type_in,
                            2,
                            Value(Q02_Txt_NumericInput.Text),
                            5,
                            Q05_Slr_Slider.Value,0
                        ),
                        ThisItem.fa_answer_type_in,
                        0,
                        varPlantId,
                        1,
                        ThisItem.fa_question_pos_in,
                        ThisItem.fa_question_required_bt,
                        ThisItem.fa_title_hide_bt,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),
                        varActiveLevel
                    )
                );
            OnSelect: =Select(Parent)
            Reset: =varResetReason
            Size: =18
            Visible: |-
                =If(
                    VarEdtRsonQusPos = ThisItem.fa_question_pos_in&&VarEdtRsonChldPos=ThisItem.fa_child_pos_in,
                    true,
                    false
                )
            Width: =Q99_Lbl_Question.Width
            X: =Q99_Lbl_Question.X
            Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 5
            ZIndex: =48

        Q98_Debug As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =48

            Debug_Shp_Backgroud As htmlViewer:
                Fill: =RGBA(0, 0, 0, 0)
                Height: =280
                HtmlText: |-
                    ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:0.95;background-color:#FFFFFF;box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
                Visible: =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                Width: =Formularios_QuestionList.TemplateWidth
                ZIndex: =23

            Debug_Lbl_Status As label:
                Align: =Align.Center
                Fill: =RGBA(232, 244, 217, 1)
                Font: ="Unity"
                Height: =31
                OnSelect: =
                Size: =18
                Text: |-
                    =If(
                        (ThisItem.fa_question_required_bt || (ThisItem.fa_answer_type_in=13  && lbl_child_enable_disable.Text = "true" )),
                        (If(
                            ThisItem.fa_answer_type_in = 0,
                            "OK",
                            If(
                                ThisItem.fa_answer_type_in = 1,
                                "OK",
                                If(
                                    ThisItem.fa_answer_type_in = 2 And ThisItem.fa_question_required_bt And Not IsBlank(Q02_Txt_NumericInput.Text),
                                    "OK",
                                    If(
                                        ThisItem.fa_answer_type_in = 3 And ThisItem.fa_question_required_bt And Not IsBlank(Q03_TextSection.Text),
                                        "OK",
                                        If(
                                            ThisItem.fa_answer_type_in = 4 And ThisItem.fa_question_required_bt And Not IsBlank(Q04_Txt_Text.Text),
                                            "OK",
                                            If(
                                                ThisItem.fa_answer_type_in = 5,
                                                "OK",
                                                If(
                                                    ThisItem.fa_answer_type_in = 6 And ThisItem.fa_question_required_bt And Not IsBlank(Q06_SelectorSection.Selected.Result),
                                                    "OK",
                                                    If(
                                                        ThisItem.fa_answer_type_in = 7 And ThisItem.fa_question_required_bt And Not IsBlank(Q07_MultipleSelectorSection.Selected.Result),
                                                        "OK",
                                                        If(
                                                            ThisItem.fa_answer_type_in = 8,
                                                            "OK",
                                                            If(
                                                                ThisItem.fa_answer_type_in = 9 And ThisItem.fa_question_required_bt And Not IsBlank(Q09_Cb_Hour.Selected.Value) And Not IsBlank(Q09_Cb_Minute.Selected.Value),
                                                                "OK",
                                                                If(
                                                                    ThisItem.fa_answer_type_in = 10,
                                                                    "OK",
                                                                    If(
                                                                        ThisItem.fa_answer_type_in = 11 And (( ThisItem.fa_question_required_bt And (CountRows(Q11_QuestionCamera_Lst_Gallery.AllItems) > 0 Or CountRows(Q11_14_TableItems.AllItems) > 0)) Or ThisItem.fq_question_type_bt <> varUserEmisorReceptor),
                                                                        "OK",
                                                                        If(
                                                                            ThisItem.fa_answer_type_in = 12 And ThisItem.fa_question_required_bt And Not IsBlank(Q12_RadioSection.Selected.Result),
                                                                            "OK",
                                                                            If(
                                                                                ThisItem.fa_answer_type_in = 13 && lbl_IsTableEmpty.Text = "false",
                                                                                "OK",
                                                                                If(
                                                                                    ThisItem.fa_answer_type_in = 14 And (ThisItem.fa_question_required_bt And (CountRows(Q14_QuestionAttachment.Attachments) > 0 Or CountRows(Q11_14_TableItems.AllItems) > 0) Or ThisItem.fq_question_type_bt <> varUserEmisorReceptor),
                                                                                    "OK",
                                                                                    If (
                                                                                        (ThisItem.fa_answer_type_in = 15) And ((lbl_sign_status.Text = "true") Or  (CountRows(Q11_14_TableItems.AllItems) > 0) Or (ThisItem.fq_question_type_bt <> varUserEmisorReceptor)),
                                                                                        "OK",
                                                                                        ""
                                                                                    )
                                                                                )
                                                                            )
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )),
                        "OK"
                    )
                Visible: =false
                Width: =72
                X: =Parent.TemplateWidth-Self.Width-20
                Y: =62
                ZIndex: =24

            Debug_Lbl_QuestionPosition As label:
                Color: =RGBA(0, 13, 75, 1)
                Font: ="Unity"
                Height: =27
                OnSelect: =Select(Parent)
                Size: =18
                Text: |-
                    ="Question Position: " & ThisItem.fa_question_pos_in
                Visible: =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                Width: =Q99_Lbl_Question.Width
                Wrap: =false
                X: =Q99_Lbl_Question.X
                Y: =107
                ZIndex: =25

            Debug_Lbl_UserType As label:
                Color: =RGBA(0, 13, 75, 1)
                Font: ="Unity"
                Height: =26
                OnSelect: =Select(Parent)
                Size: =18
                Text: |-
                    =If(ThisItem.fq_question_type_bt,"User type: User 02", "User type: User 01")
                Visible: =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                Width: =Q99_Lbl_Question.Width
                Wrap: =false
                X: =Q99_Lbl_Question.X
                Y: =148
                ZIndex: =26

            Debug_Lbl_FormType As label:
                Color: =RGBA(0, 13, 75, 1)
                Font: ="Unity"
                Height: =27
                OnSelect: =Select(Parent)
                Size: =18
                Text: |-
                    =Switch(varFormType,1,"Form Type: Simple (1)",2,"Form Type: Confirmation (2)", "Form Type: Other")
                Visible: =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                Width: =Q99_Lbl_Question.Width
                Wrap: =false
                X: =Q99_Lbl_Question.X
                Y: =189
                ZIndex: =27

            Debug_Lbl_Title As label:
                Color: =RGBA(39, 67, 125, 1)
                Font: ="Unity"
                FontWeight: =FontWeight.Semibold
                Height: =39
                OnSelect: =Select(Parent)
                Size: =18
                Text: ="Debug App"
                Visible: =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                Width: =Q99_Lbl_Question.Width
                Wrap: =false
                X: =Q00_Lbl_Title.X
                Y: =61
                ZIndex: =28

            Debug_Lbl_Answer As label:
                Color: =RGBA(0, 13, 75, 1)
                Fill: =RGBA(253, 222, 207, 1)
                Font: ="Unity"
                Height: =86
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                Size: =14
                Text: |-
                    =Switch(
                        ThisItem.fa_answer_type_in,
                        0,
                        "Title",
                        1,
                        Text(Q01_YesNoSection.Value),
                        2,
                        Text(
                            Substitute(
                                Value(Q02_Txt_NumericInput.Text),
                                ",",
                                "."
                            )
                        ),
                        3,
                        Q03_TextSection.Text,
                        4,
                        Q04_Txt_Text.Text,
                        5,
                        Text(Q05_Slr_Slider.Value),
                        6,
                        If(
                            IsBlank(Q06_SelectorSection.Selected.Result),
                            "",
                            Q06_SelectorSection.Selected.Result
                        ),
                        7,
                        If(
                            IsBlank(Q07_MultipleSelectorSection.Selected.Result),
                            "",
                            Concat(
                                Q07_MultipleSelectorSection.SelectedItems,
                                ThisRecord.Result,
                                ","
                            )
                        ),
                        8,
                        Text(
                            Q08_DateSection.SelectedDate,
                            "mm/dd/yyyy"
                        ),
                        9,
                        Concatenate(
                            Q09_Cb_Hour.Selected.Value,
                            ":",
                            If(
                                Len(Text(Q09_Cb_Minute.Selected.Value)) = 1,
                                "0" & Q09_Cb_Minute.Selected.Value,
                                Q09_Cb_Minute.Selected.Value
                            )
                        ),
                        11,
                        If(
                            CountRows(Q11_QuestionCamera_Lst_Gallery.AllItems) > 0,
                            BlobUrl & BlobPathGemba & Pr_FormNumber & "" & Substitute(
                                Substitute(
                                    Substitute(
                                        Pr_DateFilteDT,
                                        "/",
                                        ""
                                    ),
                                    ":",
                                    ""
                                ),
                                " ",
                                ""
                            ) & "" & AnsPos.Text & "" & "" & Child_pos.Text & "" & CountRows(Q11_14_TableItems.AllItems) + 1,
                            ""
                        ),
                        12,
                        If(
                            IsBlank(Q12_RadioSection.Selected.Result),
                            "",
                            Q12_RadioSection.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BResult'
                        ),
                        13,
                        /*
                        If(
                            IsBlank(
                                If(
                                    And(
                                        ThisItem.fq_question_type_bt = false,
                                        varUserEmisorReceptor = true
                                    ),
                                    ThisItem.fa_answer_text_vc,
                                    First(
                                        Filter(
                                            varTableAnswers,
                                            AnsPos = ThisItem.fa_question_pos_in,
                                            ReportDate = Pr_DateFilterIn
                                        )
                                    ).Resultado
                                )
                            ),
                            ThisItem.fa_title_description_vc,
                            If(
                                And(
                                    ThisItem.fq_question_type_bt = false,
                                    varUserEmisorReceptor = true
                                ),
                                ThisItem.fa_answer_text_vc,
                                First(
                                    Filter(
                                        varTableAnswers,
                                        AnsPos = ThisItem.fa_question_pos_in,
                                        ReportDate = Pr_DateFilterIn
                                    )
                                ).Resultado
                            )
                        )*/
                        If(
                            Len(
                                If(
                                    !(ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";"))),
                                    ThisItem.fa_answer_text_vc,
                                    First(
                                        Filter(
                                            varTableAnswers,
                                            AnsPos = ThisItem.fa_question_pos_in,
                                            ChildPos = ThisItem.fa_child_pos_in,
                                            ReportDate = Pr_DateFilterIn
                                        )
                                    ).Resultado
                                )
                            ) <= 0,
                            ThisItem.fa_title_description_vc,
                            If(
                                !(ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";"))),
                                ThisItem.fa_answer_text_vc,
                                First(
                                    Filter(
                                        varTableAnswers,
                                        AnsPos = ThisItem.fa_question_pos_in,
                                        ChildPos = ThisItem.fa_child_pos_in,
                                        ReportDate = Pr_DateFilterIn
                                    )
                                ).Resultado
                            )
                        ),
                        14,
                        If(
                            CountRows(Q14_QuestionAttachment.Attachments) > 0,
                            BlobUrl & BlobPathGemba & Pr_FormNumber & "" & Substitute(
                                Substitute(
                                    Substitute(
                                        Pr_DateFilteDT,
                                        "/",
                                        ""
                                    ),
                                    ":",
                                    ""
                                ),
                                " ",
                                ""
                            ) & "" & AnsPos.Text & "" & "" & Child_pos.Text & ""& CountRows(Q11_14_TableItems.AllItems)+1,
                            ""
                        ),
                        15,
                        If(
                            lbl_sign_status.Text = "true",
                            BlobUrl & BlobPathGemba & Pr_FormNumber & "" & Substitute(
                                Substitute(
                                    Substitute(
                                        Pr_DateFilteDT,
                                        "/",
                                        ""
                                    ),
                                    ":",
                                    ""
                                ),
                                " ",
                                ""
                            ) & "" & AnsPos.Text & "" & "" & Child_pos.Text & "" & "Signature" & CountRows(Q11_14_TableItems.AllItems) + 1,
                            ""
                        )
                    )
                Visible: |+
                    =If(VarBugPosition=ThisItem.fa_question_pos_in And varDebugBit,true,false)
                    
                    
                    
                    
                    
                Width: =Q99_Lbl_Question.Width
                Wrap: =false
                X: =80
                Y: =482
                ZIndex: =69

        Q99_Icon_Edit As icon.Add:
            Color: =If(VarBlink And Q99_Txt_EditReason.Visible And Len(Trim(Q99_Txt_EditReason.Text)) > 9,RGBA(59, 165, 168, 1),RGBA(168, 0, 0, 1))
            DisabledColor: =RGBA(202, 202, 202, 1)
            Height: =40
            Icon: |-
                =//If(Len(Trim(Q99_Txt_EditReason.Text)) <= 10 Or IsBlank(Q99_Txt_EditReason.Text) Or Len(Q99_Txt_EditReason.Text) > 10 , Icon.Edit, Icon.CheckBadge)
                If(Len(Trim(Q99_Txt_EditReason.Text)) >= 10 && !IsBlank(Q99_Txt_EditReason.Text) , Icon.CheckBadge, Icon.Edit)
            OnSelect: |-
                =/*If(
                    VarEdtRsonQusPos = 0 And (Len(Trim(Q99_Txt_EditReason.Text)) < 10 Or IsBlank(Q99_Txt_EditReason.Text)),
                    UpdateContext({VarEdtRsonQusPos: ThisItem.fa_question_pos_in}),
                    UpdateContext({VarEdtRsonQusPos: 0})
                );
                */
                If(
                    VarEdtRsonQusPos = 0 || VarEdtRsonQusPos <> 0 && (VarEdtRsonQusPos<>ThisItem.fa_question_pos_in||VarEdtRsonChldPos<>ThisItem.fa_child_pos_in) ,
                    UpdateContext({VarCommentQuesPos: 0});UpdateContext({VarCommentChildPos: 0});
                    UpdateContext({VarEdtRsonQusPos: ThisItem.fa_question_pos_in});UpdateContext({VarEdtRsonChldPos: ThisItem.fa_child_pos_in}),
                    UpdateContext({VarEdtRsonQusPos: 0});UpdateContext({VarEdtRsonChldPos: 0})
                );
                    
                    
            Visible: |-
                =//!IsBlank(ThisItem.fat_question_pos_in) And ThisItem.fq_question_type_bt = varUserEmisorReceptor And !varCompleteReader And !IsBlank(ThisItem.RowNum) And ThisItem.fa_active_level=ThisItem.fa_user_type
                !IsBlank(ThisItem.RowNum) And !varCompleteReader And !IsBlank(ThisItem.fat_question_pos_in) And ThisItem.fa_active_level in Int(Split(ThisItem.fa_user_type,";")) And Boolean(lbl_child_enable_disable.Text) And ThisItem.fa_answer_type_in<>13
            Width: =40
            X: =Formularios_QuestionList.X + Formularios_QuestionList.TemplateWidth - 28 - Self.Width
            Y: |-
                =Switch(
                    ThisItem.fa_answer_type_in,
                    1,
                    Q01_YesNoSection.Y + Q01_YesNoSection.Height + 15,
                    2,
                    Q02_Lbl_Range.Y + Q02_Lbl_Range.Height + 15,
                    3,
                    Q03_TextSection.Y + Q03_TextSection.Height + 15,
                    4,
                    Q04_Txt_Text.Y + Q04_Txt_Text.Height + 15,
                    5,
                    Q05_Lbl_Range.Y + Q05_Lbl_Range.Height + 15,
                    6,
                    Q06_SelectorSection.Y + Q06_SelectorSection.Height + 15,
                    7,
                    Q07_MultipleSelectorSection.Y + Q07_MultipleSelectorSection.Height + 15,
                    8,
                    Q08_DateSection.Y + Q08_DateSection.Height + 15,
                    9,
                    Q09_Cb_Hour.Y + Q09_Cb_Hour.Height + 15,
                    11,
                     If(
                        Q11_14_TableItems.Visible,
                        Q11_14_TableItems.Y + Q11_14_TableItems.Height + 15,
                        If(varCameraContorls<>ThisItem.fa_question_pos_in,
                        btn_launchCamera.Y + btn_launchCamera.Height + 15,
                        Q11_QuestionCamera_Lbl_Gallery.Y + Q11_QuestionCamera_Lbl_Gallery.Height + 15
                        )
                    ),
                    12,
                    Q12_RadioSection.Y + Q12_RadioSection.Height + 15,
                    13,
                    Q13_TableSection.Y + Q13_TableSection.Height + 15,
                    14,
                    If(
                        Q11_14_TableItems.Visible,
                        Q11_14_TableItems.Y + Q11_14_TableItems.Height + 15,
                        Q14_QuestionAttachment.Y + Q14_QuestionAttachment.Height + 15
                    ),
                     15,
                    Q15_Signature_PenInput.Y+Q15_Signature_PenInput.Height+15
                    ,0
                )
            ZIndex: =49

        Q99_QuestionHeader As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =49

            Q99_Shp_Background As htmlViewer:
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Formularios_QuestionList.TemplateHeight
                HtmlText: |-
                    ="<div style='margin:10px;width: " & Self.Width-18  & "px;height:" & Self.Height-32  & "px;opacity:0.8;background-color:"&If(ThisItem.fa_child_pos_in=0 || IsBlank(ThisItem.fa_child_pos_in),"#FFFFFF" ,If(lbl_child_enable_disable.Text="true","#DDF0DD","#F7E1E1"))&";box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
                    
                    /*
                    "<div style='margin:10px;width: " & Self.Width-18  & "px;height:" & Self.Height-32  & "px;opacity:0.8;background-color:"&If(ThisItem.fa_child_pos_in=0 || IsBlank(ThisItem.fa_child_pos_in),"#FFFFFF" ,With({parentTempAns:LookUp(coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0).temp_answer2},If(!IsBlank(parentTempAns) && Text(parentTempAns) in Split(ThisItem.fa_child_criteria,"$~$"),"#DDF0DD","#F7E1E1")))&";box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
                    */
                Visible: =ThisItem.fa_answer_type_in <> 0 && !IsBlank(ThisItem.RowNum)
                Width: =Formularios_QuestionList.TemplateWidth-10
                ZIndex: =1

            Q99_Icon_Requerid As icon.Add:
                Color: =RGBA(26, 150, 148, 1)
                Height: =25
                Icon: =Icon.Pin
                Visible: =false//ThisItem.fa_question_required_bt And ThisItem.fa_answer_type_in <> 0
                Width: =25
                X: =Q99_Icon_Checked.X + Q99_Icon_Checked.Width + 20
                Y: =255
                ZIndex: =51

            Q99_Icon_Checked As icon.Add:
                Color: =RGBA(26, 150, 148, 1)
                Height: =25
                Icon: |-
                    =If(Debug_Lbl_Status.Text = "OK",Icon.Check,Icon.Cancel)
                    /*If(
                        ThisItem.fa_answer_type_in = 0,
                        Icon.Check,
                        If(
                            ThisItem.fa_answer_type_in = 1,
                            Icon.Check,
                            If(
                                ThisItem.fa_answer_type_in = 2 And ThisItem.fa_question_required_bt And Not IsBlank(Txt_NumericoManual_4),
                                Icon.Check,
                                If(
                                    ThisItem.fa_answer_type_in = 3 And ThisItem.fa_question_required_bt And Not IsBlank('2_Txt_Texto_4'),
                                    Icon.Check,
                                    If(
                                        ThisItem.fa_answer_type_in = 4 And ThisItem.fa_question_required_bt And Not IsBlank(Txt_EscanerLectura_4),
                                        Icon.Check,
                                        If(
                                            ThisItem.fa_answer_type_in = 5,
                                            Icon.Check,
                                            If(
                                                ThisItem.fa_answer_type_in = 6 And ThisItem.fa_question_required_bt And Not IsBlank('5_Cb_SeleccionSimple_4'.Selected.Result),
                                                Icon.Check,
                                                If(
                                                    ThisItem.fa_answer_type_in = 7 And ThisItem.fa_question_required_bt And Not IsBlank('6_Cb_SeleccionMultiple_4'.Selected.Result),
                                                    Icon.Check,
                                                    If(
                                                        ThisItem.fa_answer_type_in = 8 And ThisItem.fa_question_required_bt And Not IsBlank('7_Dt_Fecha_4'),
                                                        Icon.Check,
                                                        If(
                                                            ThisItem.fa_answer_type_in = 11,
                                                            Icon.Check,
                                                                If(
                                                                ThisItem.fa_answer_type_in = 12,
                                                                Icon.Check,
                                                                Icon.Cancel
                                                                )
                                                        )
                                                        
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            )
                        )
                    )*/
                Visible: =false//ThisItem.fa_question_required_bt And ThisItem.fa_answer_type_in <> 0
                Width: =25
                X: =Q99_Icon_Notes.X + Q99_Icon_Notes.Width + 20
                Y: =255
                ZIndex: =52

            Q99_Lbl_Required As label:
                Color: =RGBA(168, 0, 0, 1)
                Font: ="Unity"
                FontWeight: =FontWeight.Bold
                Height: =61
                Overflow: =Overflow.Scroll
                Size: =23
                Text: ="*"
                Visible: =ThisItem.fa_question_required_bt And ThisItem.fa_answer_type_in <> 0 && !IsBlank(ThisItem.RowNum)
                Width: =23
                X: =57
                Y: =61
                ZIndex: =53

            Q99_Icon_Debug As icon.Add:
                Color: =RGBA(26, 150, 148, 1)
                Height: =25
                Icon: =Icon.Bug
                OnSelect: |-
                    =If(
                        VarBugPosition = 0,
                        UpdateContext({VarBugPosition: ThisItem.fa_question_pos_in}),
                        UpdateContext({VarBugPosition: 0})
                    )
                Visible: |
                    =varDebugBit
                Width: =25
                X: =Q99_Shp_Background.X + Q99_Shp_Background.Width - Self.Width - 20
                Y: =61
                ZIndex: =54

            Q99_Icon_Notes As icon.Add:
                Color: =RGBA(26, 150, 148, 1)
                Height: =40
                Icon: =Icon.Message
                OnSelect: |-
                    =If(
                        VarCommentQuesPos = 0 || VarCommentQuesPos <> 0 && (VarCommentQuesPos<>ThisItem.fa_question_pos_in||VarCommentChildPos<>ThisItem.fa_child_pos_in),
                        UpdateContext({VarEdtRsonQusPos: 0});UpdateContext({VarEdtRsonChldPos: 0});
                        UpdateContext({VarCommentQuesPos: ThisItem.fa_question_pos_in});UpdateContext({VarCommentChildPos: ThisItem.fa_child_pos_in}),
                         VarCommentQuesPos <> 0 && VarCommentQuesPos<>ThisItem.fa_question_pos_in,
                         VarCommentQuesPos =ThisItem.fa_question_pos_in,
                    
                    
                        UpdateContext({VarCommentQuesPos: 0});UpdateContext({VarCommentChildPos: 0})
                    )
                Visible: =ThisItem.fa_answer_type_in <> 0 && !IsBlank(ThisItem.RowNum)
                Width: =40
                X: =66
                Y: |
                    =Switch(
                        ThisItem.fa_answer_type_in,
                        1,
                        Q01_YesNoSection.Y + Q01_YesNoSection.Height + 15,
                        2,
                        Q02_Lbl_Range.Y + Q02_Lbl_Range.Height + 15,
                        3,
                        Q03_TextSection.Y + Q03_TextSection.Height + 15,
                        4,
                        Q04_Txt_Text.Y + Q04_Txt_Text.Height + 15,
                        5,
                        Q05_Lbl_Range.Y + Q05_Lbl_Range.Height + 15,
                        6,
                        Q06_SelectorSection.Y + Q06_SelectorSection.Height + 15,
                        7,
                        Q07_MultipleSelectorSection.Y + Q07_MultipleSelectorSection.Height + 15,
                        8,
                        Q08_DateSection.Y + Q08_DateSection.Height + 15,
                        9,
                        Q09_Cb_Hour.Y + Q09_Cb_Hour.Height + 15,
                        11,
                        If(
                            Q11_14_TableItems.Visible,
                            Q11_14_TableItems.Y + Q11_14_TableItems.Height + 15,
                            If(varCameraContorls<>ThisItem.fa_question_pos_in,
                            btn_launchCamera.Y + btn_launchCamera.Height + 15,
                            Q11_QuestionCamera_Lbl_Gallery.Y + Q11_QuestionCamera_Lbl_Gallery.Height + 15
                            )
                        ),
                        12,
                        Q12_RadioSection.Y + Q12_RadioSection.Height + 15,
                        13,
                        Q13_TableSection.Y + Q13_TableSection.Height + 15,
                        14,
                        If(
                            Q11_14_TableItems.Visible,
                            Q11_14_TableItems.Y + Q11_14_TableItems.Height + 15,
                            Q14_QuestionAttachment.Y + Q14_QuestionAttachment.Height + 15
                        ),
                        15,
                        Q15_Signature_PenInput.Y+Q15_Signature_PenInput.Height+15
                        ,0
                    )
                    /*And(
                                !ThisItem.fq_question_type_bt = varUserEmisorReceptor,
                                Or(
                                    ThisItem.fa_answer_type_in = 14,
                                    ThisItem.fa_answer_type_in = 11
                                )
                            )*/
                ZIndex: =55

            Q99_Txt_Notes As text:
                BorderColor: =RGBA(128, 128, 128, 1)
                BorderThickness: =1
                Default: =ThisItem.fa_comment_vc
                DisabledBorderColor: =RGBA(116, 116, 116, 1)
                DisabledFill: =RGBA(237, 237, 237, 1)
                DisplayMode: |-
                    =//If(And(ThisItem.fq_question_type_bt = false, varUserEmisorReceptor = true),DisplayMode.Disabled,DisplayMode.Edit)
                    //If(ThisItem.fa_active_level<>ThisItem.fa_user_type,DisplayMode.Disabled,DisplayMode.Edit)
                     If((ThisItem.fa_active_level = Int(ThisItem.fa_user_type)),DisplayMode.Edit, And(Pr_ReviewMode = 1, ThisItem.fa_answer_type_in <> 0 ) && !IsBlank(ThisItem.RowNum),DisplayMode.Edit,DisplayMode.Disabled)
                FontWeight: =FontWeight.Bold
                Height: =Q99_Icon_Notes.Y - Self.Y - 5
                HintText: ="..."
                HoverBorderColor: =RGBA(116, 116, 116, 1)
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =500
                Mode: =TextMode.MultiLine
                OnChange: |
                    =If(
                        varSingleValidation = 1 And varLoadingVisible = false And ((varIsFormRequest.fr_status_in = 1 And ThisItem.fq_question_type_bt = true) Or IsBlank(varIsFormRequest)) And VarCommentQuesPos = ThisItem.fa_question_pos_in And VarCommentChildPos=ThisItem.fa_child_pos_in,
                        fa_AnswerReport.Run(
                            ThisItem.fa_answer_list_vc,
                            Switch(
                                ThisItem.fa_answer_type_in,
                                6,
                                If(
                                    IsBlank(Q06_SelectorSection.Selected.Result),
                                    "",
                                    Q06_SelectorSection.Selected.Result
                                ),
                                12,
                                If(
                                    IsBlank(Q12_RadioSection.Selected.Result),
                                    "",
                                    Q12_RadioSection.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1BResult'
                                ),
                                3,
                                Q03_TextSection.Text,
                                4,
                                Q04_Txt_Text.Text,
                                7,
                                If(
                                    IsBlank(Q07_MultipleSelectorSection.Selected.Result),
                                    "",
                                    Q07_MultipleSelectorSection.Selected.Result
                                ),
                                8,
                                Q08_DateSection.SelectedDate,""
                            ),
                            User().Email,
                            "Update",
                            ThisItem.fa_form_number_vc,
                            ThisItem.fa_label_off_vc,
                            ThisItem.fa_label_on_vc,
                            ThisItem.fa_question_description_vc,
                            ThisItem.fa_title_description_vc,
                            ThisItem.fa_title_name_vc,
                            Pr_DateFilteDT,
                            Q99_Txt_Notes.Text,
                            Q01_YesNoSection.Value,
                            ThisItem.fa_answer_characters_in,
                            ThisItem.fa_answer_max_dc,
                            ThisItem.fa_answer_min_dc,
                            Switch(
                                ThisItem.fa_answer_type_in,
                                2,
                                Value(Q02_Txt_NumericInput.Text),
                                5,
                                Q05_Slr_Slider.Value,0
                            ),
                            ThisItem.fa_answer_type_in,
                            0,
                            varPlantId,
                            1,
                            ThisItem.fa_question_pos_in,
                            ThisItem.fa_question_required_bt,
                            ThisItem.fa_title_hide_bt,
                            Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),
                            varActiveLevel
                        )
                    );
                OnSelect: =Select(Parent)
                Size: =23
                Visible: =If(VarCommentQuesPos=ThisItem.fa_question_pos_in&&VarCommentChildPos=ThisItem.fa_child_pos_in && !IsBlank(ThisItem.RowNum),true,false)
                Width: =Q99_Lbl_Question.Width
                X: =Q99_Lbl_Question.X
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + 5
                ZIndex: =56

        Notes_Commented As image:
            Height: =36
            Image: |-
                ="data:image/svg+xml;utf8, %3Csvg%20%20viewBox%3D%270%200%202048%202048%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%3E%3Cpath%20d%3D%27M2048%20128v1408H731l-475%20475v-475H0V128h2048z%27%20fill%3D%27%23038387%27%3E%3C%2Fpath%3E%3C%2Fsvg%3E"
            OnSelect: |-
                =If(
                    VarCommentQuesPos = 0,
                    UpdateContext({VarCommentQuesPos: ThisItem.fa_question_pos_in});UpdateContext({VarCommentChildPos: ThisItem.fa_child_pos_in}),
                    UpdateContext({VarCommentQuesPos: 0});UpdateContext({VarCommentChildPos: 0})
                )
            Visible: =ThisItem.fa_answer_type_in <> 0 && !IsBlank(ThisItem.fa_comment_vc) && !IsBlank(ThisItem.RowNum)
            Width: =38
            X: =Q99_Icon_Notes.X
            Y: =Q99_Icon_Notes.Y
            ZIndex: =50

        Q99_Lbl_Question As text:
            Align: =Align.Justify
            BorderThickness: =0
            Color: |
                =If(
                    And(
                        VarBlink,
                        VarPendingIndicatorTimer,
                        Debug_Lbl_Status.Text <> "OK"
                     ),
                    RGBA(
                        209,
                        105,
                        106,
                        1
                    ),
                    RGBA(
                        0,
                        0,
                        0,
                        1
                    )
                )
            Default: |-
                =If(
                    VarCommentQuesPos = ThisItem.fa_question_pos_in && VarCommentChildPos=ThisItem.fa_child_pos_in,
                    First(collAppLanguage).Lbl_Question_1,
                    If(
                        VarEdtRsonQusPos = ThisItem.fa_question_pos_in&&VarEdtRsonChldPos=ThisItem.fa_child_pos_in,
                        First(collAppLanguage).Q99_Lbl_Question,
                        If(
                            ThisItem.fa_answer_type_in <> 0,
                            Coalesce(ThisItem.fa_question_description_vc," "),
                            Coalesce(ThisItem.fa_title_name_vc," ")
                        )
                    )
                )
            DisplayMode: =DisplayMode.View
            Fill: =Q99_Shp_Background.Fill
            FontWeight: =FontWeight.Semibold
            Height: |-
                =//200 HiddenHTMLQuestion.Height<50,50,
                If(HiddenHTMLQuestion.Height<=124,70,HiddenHTMLQuestion.Height>200,200,HiddenHTMLQuestion.Height)
            Mode: =TextMode.MultiLine
            OnSelect: =Select(Parent)
            Size: =25
            Visible: =ThisItem.fa_answer_type_in <> 0 && !IsBlank(ThisItem.RowNum)
            Width: =Q99_Icon_Debug.X - Self.X
            X: =Q99_Lbl_Required.X + Q99_Lbl_Required.Width
            Y: =58
            ZIndex: =57

        Label15 As label:
            Height: =70
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                =//Q99_Icon_Notes.Y + Q99_Icon_Notes.Height + 58
                Max(Q99_Icon_Notes.Y + Q99_Icon_Notes.Height + 58,Notes_Commented.Y+Notes_Commented.Height+58,
                Q00_Lbl_Subtitle.Y+Q00_Lbl_Subtitle.Height+58)
            Visible: =false
            Width: =193
            X: =358
            Y: =33
            ZIndex: =58

        llbl_hiddenQuestionHeight As label:
            Height: =42
            OnSelect: =Select(Parent)
            Size: =21
            Text: =HiddenHTMLQuestion.Height
            Visible: =false
            Width: =78
            X: =537
            Y: =100
            ZIndex: =59

        lbl_IsTableEmpty As label:
            Fill: =RGBA(253, 222, 207, 1)
            FontWeight: =FontWeight.Semibold
            Height: =30
            OnSelect: =Select(Parent)
            Size: =15
            Text: |-
                =With({ThisTable:ForAll(
                With({Resultado:First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ChildPos=ThisItem.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado},If(!IsBlank(Resultado),Split(Substitute(Resultado,"|","^"),"^"),
                Split(Substitute(ThisItem.fa_title_description_vc,"|","^"),"^")
                ))
                
                ,
                          With(
                            {
                                parts: Split(ThisRecord.Value, "~")
                            },
                            {
                                Cell_Column: Text(First(parts).Value),
                                Cell_Row: (Last(FirstN(parts, 2)).Value),
                                Cell_Type: (Last(FirstN(parts, 3)).Value),
                                Cell_DefaultValue: (Last(FirstN(parts, 4)).Value),
                                Cell_Mode: (Last(FirstN(parts, 5)).Value),
                                IsRequired: With({IsRequired:(Last(FirstN(parts, 6)).Value)},If(!IsBlank(IsRequired),IsRequired,"Not Mention"))
                            }
                        ))},If(ThisItem.fa_question_required_bt && CountRows(Filter(ThisTable,Cell_Type="NumericInput",Cell_Mode="Write"))=0,false,
                            ThisItem.fa_question_required_bt && CountRows(Filter(ThisTable,IsRequired="Required"))=0,CountRows(Filter(ThisTable,Cell_Type="NumericInput",Cell_Mode="Write",!IsBlank(Cell_DefaultValue)))=0,
                            CountRows(Filter(ThisTable,IsRequired="Required",IsBlank(Cell_DefaultValue),Cell_Type="NumericInput" || Cell_Type="Selector"
                ))>=1))
                /*CountRows(
                Filter(
                ForAll(
                With({Resultado:First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ChildPos=ThisItem.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado},If(!IsBlank(Resultado),Split(Substitute(Resultado,"|","^"),"^"),
                Split(Substitute(ThisItem.fa_title_description_vc,"|","^"),"^")
                ))
                
                ,
                          With(
                            {
                                parts: Split(ThisRecord.Value, "~")
                            },
                            {
                                Cell_Column: Text(First(parts).Value),
                                Cell_Row: (Last(FirstN(parts, 2)).Value),
                                Cell_Type: (Last(FirstN(parts, 3)).Value),
                                Cell_DefaultValue: (Last(FirstN(parts, 4)).Value),
                                Cell_Mode: (Last(FirstN(parts, 5)).Value),
                                IsRequired: (Last(parts).Value)
                            }
                        )
                    ), IsRequired="Required",IsBlank(Cell_DefaultValue),Cell_Type="NumericInput" || Cell_Type="Selector"
                ))>=1
                */
                /*If(If(
                Len(ThisItem.fa_answer_text_vc)=0,"Write" in ThisItem.fa_title_description_vc,"Write" in ThisItem.fa_answer_text_vc)=false,false,
                    Len(
                If(
                            (
                                ThisItem.fa_active_level <> ThisItem.fa_user_type
                            ),
                            ThisItem.fa_answer_text_vc,
                            First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ChildPos=ThisItem.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado
                        )
                )=0,true,
                Concat(ForAll(
                Split(ThisItem.fa_title_description_vc,"^"),Substitute(ThisRecord.Value,Match(ThisRecord.Value, "Compute~.*?~").FullMatch, "Compute~~"))
                ,Value,"^")=
                
                If(
                             (
                                ThisItem.fa_active_level <> ThisItem.fa_user_type
                            ),
                            Concat(ForAll(
                Split(ThisItem.fa_answer_text_vc,"^"),Substitute(ThisRecord.Value,Match(ThisRecord.Value, "Compute~.*?~").FullMatch, "Compute~~"))
                ,Value,"^"),
                Concat(ForAll(
                Split( First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = ThisItem.fa_question_pos_in,
                                    ChildPos= ThisItem.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ).Resultado,"^"),Substitute(ThisRecord.Value,Match(ThisRecord.Value, "Compute~.*?~").FullMatch, "Compute~~"))
                ,Value,"^")
                           
                        
                ))
                
                
                
                
                
                */
            Visible: =false
            Width: =60
            X: =Parent.TemplateWidth-Self.Width-20
            Y: =21
            ZIndex: =60

        lbl_criteria As label:
            FontWeight: =FontWeight.Semibold
            Height: =45
            OnSelect: =Select(Parent)
            Overflow: =Overflow.Scroll
            Size: =14
            Text: |
                ="Criteria: Q"&LookUp(coltestanswere,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0).RowNum & "= " & Substitute(ThisItem.fa_child_criteria,"$~$"," or ")
            Visible: |
                =ThisItem.fa_child_pos_in<>0 && Len(ThisItem.fa_question_pos_in)>=1
            Width: =400
            X: =Parent.X+Parent.TemplateWidth-Self.Width-20
            Y: =21
            ZIndex: =61

        Q11_QuestionCamera As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =64

            Rectangle2 As rectangle:
                ContentLanguage: =ThisItem.fa_question_description_vc
                Fill: =RGBA(255, 255, 255, 1)
                Height: =620
                OnSelect: |-
                    =UpdateContext({varImage:Blank()})
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =Formularios_QuestionList.TemplateWidth
                ZIndex: =31

            Q11_Shp_Background As htmlViewer:
                ContentLanguage: =ThisItem.fa_question_description_vc
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Q99_Shp_Background.Height
                HtmlText: |-
                    ="<div style='margin:10px;width: " & Self.Width-18  & "px;height:" & Self.Height-32  & "px;opacity:0.8;background-color:#FFFFFF;box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
                Visible: |
                    =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =Formularios_QuestionList.TemplateWidth-10
                X: =10
                ZIndex: =32

            Q11_QuestionCamera_Lst_Gallery As gallery.galleryVertical:
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(227, 234, 243, 1)
                BorderThickness: =1
                ContentLanguage: =ThisItem.fa_question_description_vc
                Height: =Q11_QuestionCamera_Camera.Height
                Items: =Filter(Q11_TemporalPictures,AnsPosition = ThisItem.fa_question_pos_in&&ChildPosition=ThisItem.fa_child_pos_in)
                Layout: =Layout.Vertical
                TemplateSize: =99
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =Q99_Lbl_Question.Width/2
                X: =Q99_Lbl_Question.X
                Y: =Q11_QuestionCamera_Camera.Y
                ZIndex: =33

                Q11_QuestionCamera_Img_Image As image:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Height: =84
                    Image: =ThisItem.Label
                    OnSelect: |-
                        =UpdateContext({varImageBigScale:true});
                        UpdateContext({varThisItemImages:Q11_QuestionCamera_Lst_Gallery.AllItems});
                        UpdateContext({varPictureNumber:ThisItem.Id});
                        //UpdateContext({varSortImagesID:SortByColumns(varThisItemImages.Id,SortOrder.Ascending)})
                    Width: =109
                    X: =75
                    Y: =10
                    ZIndex: =1

                Q11_QuestionCamera_Lbl_Pos As label:
                    Fill: =RGBA(227, 234, 243, 0.79)
                    Font: ="Unity"
                    FontWeight: =FontWeight.Semibold
                    OnSelect: =Select(Parent)
                    Size: =12
                    Text: =ThisItem.Id + CountRows(Q11_14_TableItems.AllItems)
                    Width: =35
                    Y: =21
                    ZIndex: =2

                Q11_QuestionCamera_Btn_Delete As icon.Check:
                    Color: =RGBA(0, 0, 0, 1)
                    Height: =35
                    Icon: =Icon.Trash
                    OnSelect: =Remove(Q11_TemporalPictures,ThisItem)
                    Width: =34
                    X: =Q11_QuestionCamera_Lst_Gallery.TemplateWidth - Self.Width -10
                    Y: =30
                    ZIndex: =3

            Q11_QuestionCamera_Lbl_Gallery As label:
                Color: =RGBA(255, 255, 255, 1)
                ContentLanguage: =ThisItem.fa_question_description_vc
                Fill: =RGBA(59, 165, 168, 0.64)
                Font: ="Unity"
                Height: =60
                OnSelect: =Select(Parent)
                Size: =15
                Text: ="Gallery (" & CountRows(Q11_QuestionCamera_Lst_Gallery.AllItems) & " of 5)"
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =Q99_Lbl_Question.Width
                X: =Q99_Lbl_Question.X
                Y: =Q11_QuestionCamera_Camera.Y+Q11_QuestionCamera_Camera.Height
                ZIndex: =34

            Q11_QuestionCamera_Selector As dropdown:
                BorderColor: =RGBA(130, 141, 158, 1)
                ChevronBackground: =RGBA(166, 166, 166, 1)
                ChevronHoverBackground: =RGBA(130, 141, 158, 1)
                ContentLanguage: =ThisItem.fa_question_description_vc
                Font: ="Unity"
                Height: =Q11_QuestionCamera_Lbl_Gallery.Height
                Items: =Sort(Q11_QuestionCamera_Camera.AvailableDevices, Name)
                OnSelect: =Select(Parent)
                SelectionFill: =RGBA(214, 223, 238, 1)
                Size: =15
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =300
                X: =Q11_QuestionCamera_Lbl_Gallery.X + Q11_QuestionCamera_Lbl_Gallery.Width - Self.Width - 10
                Y: =Q11_QuestionCamera_Lbl_Gallery.Y 
                ZIndex: =35

            Q99_Lbl_Required_1 As label:
                Color: =RGBA(168, 0, 0, 1)
                ContentLanguage: =ThisItem.fa_question_description_vc
                Font: ="Unity"
                FontWeight: =FontWeight.Bold
                Height: =61
                Overflow: =Overflow.Scroll
                Size: =23
                Text: ="*"
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =23
                X: =Q99_Lbl_Required.X
                Y: =Q99_Lbl_Required.Y
                ZIndex: =36

            icn_cancel As icon.CancelBadge:
                Color: |-
                    =RGBA(
                            26,
                            150,
                            148,
                            1
                        )
                ContentLanguage: =ThisItem.fa_question_description_vc
                Height: =40
                Icon: =Icon.CancelBadge
                OnSelect: |
                    =UpdateContext({varCameraContorls:Blank()});
                    Reset(Formularios_QuestionList);
                    Set(
                        varNextAnswer,
                        If(App.Width<=1229,
                        ThisItem.RowNum-1,App.Width<=2650,If(Mod(ThisItem.questionNumberNew,2)=0,ThisItem.RowNum-2,ThisItem.RowNum-1),If(Mod(ThisItem.questionNumberNew,3)=0,ThisItem.RowNum-2,Mod(ThisItem.questionNumberNew,3)=2||ThisItem.questionNumberNew=2,ThisItem.RowNum-1,ThisItem.RowNum))
                    );
                     
                    Reset(Formularios_QuestionList)
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =40
                X: =Q99_Lbl_Question.X+Q99_Lbl_Question.Width
                Y: =Q99_Lbl_Question.Y
                ZIndex: =37

            Q11_QuestionCamera_Camera As camera:
                BorderColor: =RGBA(227, 234, 243, 1)
                BorderThickness: =1
                Camera: =If(IsBlankOrError(Q11_QuestionCamera_Selector.Selected.Id),0,Q11_QuestionCamera_Selector.Selected.Id)
                ContentLanguage: =ThisItem.fa_question_description_vc
                Height: =280
                OnSelect: |-
                    =If(RoundUp(((Len(JSON(Q11_QuestionCamera_Camera.Photo,JSONFormat.IgnoreBinaryData))-814)/1.37)/1000,0)>0,
                    If(
                        CountRows(Filter(Q11_TemporalPictures,AnsPosition = ThisItem.fa_question_pos_in && ChildPosition=ThisItem.fa_child_pos_in) ) < 5,
                        Collect(
                            Q11_TemporalPictures,
                            {
                                Label: Q11_QuestionCamera_Camera.Photo,
                                Id: CountRows(Q11_TemporalPictures) + 1,
                                AnsPosition: ThisItem.fa_question_pos_in,
                                ChildPosition: ThisItem.fa_child_pos_in
                            }
                        ),
                        ""
                    ),Notify("Size of the image is 0 byte re capture the picture",NotificationType.Error))
                Visible: =varCameraContorls=ThisItem.fa_question_pos_in && !IsBlank(ThisItem.RowNum) && varCameraChild=ThisItem.fa_child_pos_in
                Width: =Q99_Lbl_Question.Width/2
                X: =Q99_Lbl_Question.X+Q99_Lbl_Question.Width-Self.Width
                Y: =Q99_Lbl_Question.Y + Q99_Lbl_Question.Height + Q11_14_Icon_Switch.Height+10
                ZIndex: =40

        lbl_child_enable_disable As label:
            Height: =44
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                =
                
                    If(
                    ThisItem.fa_child_pos_in=0,true ,With({parentTempAns:LookUp(coltestanswere2,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=0).temp_answer2},If(!IsBlank(parentTempAns) && Trim(Text(parentTempAns)) in ForAll(Split(ThisItem.fa_child_criteria,"$~$"),{Result:Trim(Text(Value))}),true,false)))
            Visible: =false
            Width: =89
            X: =511
            Y: =66
            ZIndex: =65

        "'Q0 title group' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =65

            Q00_Shp_Background As htmlViewer:
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Q99_Shp_Background.Height
                HtmlText: |-
                    =
                    "<div style='margin:10px;width: " & Self.Width - 18 & "px;height:" & Self.Height - 32 & "px;opacity:0.8;background-color:#3BA5A8;box-shadow:0 3px 6px 1px  #ccc; border-radius:10px'></div>"
                Visible: =ThisItem.fa_answer_type_in = 0
                Width: =Formularios_QuestionList.TemplateWidth-10
                ZIndex: =62

            Q00_Lbl_Subtitle As text:
                BorderThickness: =0
                Color: =RGBA(255, 255, 255, 1)
                Default: =ThisItem.fa_title_description_vc
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =200
                Mode: =TextMode.MultiLine
                OnSelect: =Select(Parent)
                Size: =22
                Visible: =ThisItem.fa_answer_type_in = 0
                Width: =Q00_Shp_Background.Width - 100
                X: =Q99_Lbl_Required.X + Q99_Lbl_Required.Width
                Y: |-
                    =//Q00_Lbl_Title.Y + Q00_Lbl_Title.Height
                    Q00_Lbl_Title.Y + Q00_Lbl_Title.Height + 10
                ZIndex: =63

            Q00_Lbl_Title As text:
                BorderThickness: =0
                Color: =RGBA(255, 255, 255, 1)
                Default: =ThisItem.fa_title_name_vc
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0.1)
                Height: |-
                    =//200
                    If(HiddenHTMLQuestion.Height<=124,70,HiddenHTMLQuestion.Height>200,200,HiddenHTMLQuestion.Height)
                Mode: =TextMode.MultiLine
                OnSelect: =Select(Parent)
                Size: =28
                Visible: =ThisItem.fa_answer_type_in = 0
                Width: =Q00_Shp_Background.Width - 100
                X: =Q99_Lbl_Required.X + Q99_Lbl_Required.Width
                Y: =60
                ZIndex: =64

        Child_pos As label:
            Color: =RGBA(0, 13, 75, 1)
            Font: ="Unity"
            Height: =27
            OnSelect: =Select(Parent)
            Size: =18
            Text: =ThisItem.fa_child_pos_in
            Visible: =false
            Width: =100
            Wrap: =false
            X: =500
            Y: =80
            ZIndex: =66

        lbl_sign_status As label:
            Fill: =RGBA(253, 222, 207, 1)
            Height: =42
            OnSelect: =Select(Parent)
            Size: =21
            Text: |-
                =If(ThisItem.fa_answer_type_in=15,
                LookUp(ColSignaturesStatus,fa_question_pos_in=ThisItem.fa_question_pos_in&&fa_child_pos_in=ThisItem.fa_child_pos_in,hasSigned))
            Visible: =false
            Width: =100
            X: =500
            Y: =119
            ZIndex: =67

        btn_serial_number As button:
            BorderColor: |-
                =If(ThisItem.fa_answer_type_in = 0,Color.DimGrey,ColorValue("#3BA5A8"))
            Color: |-
                =ColorValue("#3BA5A8")
            Fill: =RGBA(255, 255, 255, 1)
            HoverColor: |-
                =ColorValue("#3BA5A8")
            HoverFill: =RGBA(255,255,255,255)
            PressedColor: |-
                =ColorValue("#3BA5A8")
            PressedFill: =RGBA(255,255,255,255)
            RadiusBottomLeft: =20
            RadiusBottomRight: =20
            RadiusTopLeft: =20
            RadiusTopRight: =20
            Size: =13
            Text: =ThisItem.RowNum
            Visible: =!IsBlank(ThisItem.RowNum)
            Width: =40
            X: =25
            Y: =25
            ZIndex: =68

    Rectangle1 As rectangle:
        Fill: =RGBA(237, 242, 242, 1)
        Height: =Progress_Autosave.Height
        Width: =App.Width
        Y: =Progress_Autosave.Y
        ZIndex: =3

    btn_sendBack As button:
        Color: |-
            =ColorValue("#3BA5A8")
        DisplayMode: |-
            =If(Find(
                        Lower(User().Email),
                        LookUp(
                            'dsf.form_level_desc',
                            nu_form_number_vc = Pr_FormNumber And nu_plant_id_in = varPlantId And nu_user_level=varActiveLevel
                        ).nu_users_email_tx
                    ),DisplayMode.Edit,DisplayMode.Disabled)
        Fill: =RGBA(255,255,255,1)
        Height: =60
        HoverFill: =ColorFade(Self.Color, -20%)
        OnSelect: |-
            =If(
                IsHRecord,
                UpdateContext({varLevel1User: Blank()});
                If(
                    !IBMS,
                    UpdateContext(
                        {
                            varLevel1User: dsf_get_level1_user_details.Run(
                                varPlantId,
                                Pr_FormNumber,
                                Pr_DateFilteDT
                            )
                        }
                    )
                );
                If(
                    IBMS || (varUserId = First(varLevel1User).sf_user_id_bin),
                    Reset(cmb_sendback_level);
                    Reset(txt_reason_sendBack);
                    UpdateContext({varSBPopup: true}),
                    Notify(
                        "You don't have sufficient rights to Send Back",
                        NotificationType.Warning
                    )
                ),
                Reset(cmb_sendback_level);
                Reset(txt_reason_sendBack);
                UpdateContext({varSBPopup: true})
            )
        PaddingBottom: =10
        PaddingLeft: =60
        PaddingTop: =10
        PressedColor: =Self.Color
        PressedFill: =Color.WhiteSmoke
        RadiusBottomLeft: =60
        RadiusBottomRight: =60
        RadiusTopLeft: =60
        RadiusTopRight: =60
        Size: =19
        Text: ="Send Back"
        Visible: |-
            =If(IsHRecord,true,
                First(coltestanswere).fa_active_level>1 && (varItemStatus<>2) && If(Or(
                    varCompleteReader,
                    Pr_ReviewMode = 1
                ),false,true))
        Width: =208
        X: =Formularios_Header_Tmr_LoadingScreen.X-Self.Width-30
        Y: =27
        ZIndex: =5

    Icon1 As icon.Send:
        Color: |-
            =ColorValue("#3BA5A8")
        DisplayMode: |-
            =If(Find(
                        Lower(User().Email),
                        LookUp(
                            'dsf.form_level_desc',
                            nu_form_number_vc = Pr_FormNumber And nu_plant_id_in = varPlantId And nu_user_level=varActiveLevel
                        ).nu_users_email_tx
                    ),DisplayMode.Edit,DisplayMode.Disabled)
        Height: =52
        Icon: =Icon.Send
        OnSelect: =Select(btn_sendBack)
        Rotation: =180
        Visible: =btn_sendBack.Visible
        Width: =72
        X: =btn_sendBack.X
        Y: =30
        ZIndex: =6

    "Progress_Autosave As 'Progress Bar'":
        BasePaletteColor: =RGBA(153, 207, 236, 1)
        DisplayMode: =DisplayMode.Edit
        Height: =41
        Max: =tmr_AutoSave.Duration
        ProgressColor: |+
            ="Brand"
            
        Thickness: ='Progress.Thickness'.Large
        Value: =tmr_AutoSave.Value
        Width: =Formularios_Header_Btn_Notification.X+Formularios_Header_Btn_Notification.Width/2
        X: =Formularios_Header_Lbl_ScreenTitle.X
        Y: =Formularios_QuestionList.Y-20
        ZIndex: =19

    Formularios_Footer_Icon_Submit_1 As icon.Add:
        Color: =RGBA(40, 60, 97, 1)
        DisabledColor: =RGBA(202, 202, 202, 1)
        DisplayMode: |-
            =If(Or(varCompleteReader, Pr_ReviewMode = 1),
            DisplayMode.Disabled,
            DisplayMode.Edit)
        Height: =Formularios_Footer_Shp_Background.Height * 0.6 
        Icon: =Icon.LevelsLayersItems
        OnSelect: =
        Tooltip: ="Configuracin"
        Width: =stIconWidth
        X: =(Parent.Width*2/4) - (Formularios_Footer_Icon_Pending.Width/2)
        Y: =Formularios_Footer_Shp_Background.Y + Formularios_Footer_Shp_Background.Height * 0.1
        ZIndex: =22

    Formularios_Footer_Lbl_Submit_1 As label:
        Align: =Align.Center
        BorderColor: =RGBA(0, 0, 0, 1)
        Color: =RGBA(130, 141, 158, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(202, 202, 202, 1)
        DisplayMode: |-
            =If(Or(varCompleteReader, Pr_ReviewMode = 1),
            DisplayMode.Disabled,
            DisplayMode.Edit)
        Font: =stFontType
        FontWeight: =FontWeight.Lighter
        Height: =17
        OnSelect: =
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =10
        Text: =First(collAppLanguage).Formularios_Footer_Lbl_Submit_1
        VerticalAlign: =VerticalAlign.Top
        Width: =74
        X: =Formularios_Footer_Icon_Submit_1.X + (Formularios_Footer_Icon_Submit_1.Width/2) - (Formularios_Footer_Lbl_Submit_1.Width/2)
        Y: =Parent.Height - Self.Height - Formularios_Footer_Icon_Submit_1.Height * 0.1
        ZIndex: =23

    Formularios_Footer_Btn_Submit_1 As button:
        AutoDisableOnSelect: =false
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderThickness: =0
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(0, 0, 0, 0)
        DisabledFill: =RGBA(0, 0, 0, 0)
        DisplayMode: |-
            =If(
                Or(
                    varCompleteReader,
                    Pr_ReviewMode = 1
                ),
                DisplayMode.Disabled,
                DisplayMode.Edit
            )
        Fill: =RGBA(0, 0, 0, 0)
        Height: =Formularios_Footer_Shp_Background.Height
        HoverBorderColor: =
        HoverFill: =
        OnSelect: |-
            =Clear(colOutofRange);
            Set(AutoSave,true);
            Set(AutoSave,false);
            ForAll(Filter(Formularios_QuestionList.AllItems,fa_answer_type_in = 2) As Record,
            If(
            Value(
                    If(
                        IsBlank(Record.Q02_Txt_NumericInput.Text),
                        0,
                        Record.Q02_Txt_NumericInput.Text
                    )
                ) > Record.fa_answer_max_dc Or Value(
                    If(
                        IsBlank(Record.Q02_Txt_NumericInput.Text),
                        0,
                        Record.Q02_Txt_NumericInput.Text
                    )
                ) < Record.fa_answer_min_dc,Collect(colOutofRange,{Question:Record.fa_question_description_vc ,Input:Record.Q02_Txt_NumericInput.Text,MinValue:Record.fa_answer_min_dc,MaxValue:Record.fa_answer_max_dc})));
                
            If(CountRows(colOutofRange)>0,UpdateContext({varConfirmPopup:true});UpdateContext({varSaveType:"Partial"}),
            UpdateContext({varLoadingVisible: true});
            UpdateContext({vasStartTimerEvaluate: true});
            //UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
            //UpdateContext({varPO: First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer});
            
            //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
            Clear(varResponse);
            Clear(colBlobMedia);
            ClearCollect(
                varResponse,
                fa_AnswerReport_Opt.Run(
                    varUserEmail,
                    Concat(
                       Formularios_QuestionList.AllItems As Item ,
                        Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                    ),
                    varFormNum,
                    Pr_DateFilteDT,
                    0,//paramFormType,
                    If(
                        varUserEmisorReceptor,
                        1,
                        0
                    ),
                    Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),If(varFormType = 2,First(coltestanswere).fa_active_level,1),If(varFormType = 2,First(coltestanswere).fa_total_question_level,1)
            ));
            //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
            If(
                varDebugBit = 1 And !IsBlank(varDebugEmail),
                Send_Team_Messagev2.Run(
                    varDebugEmail,
                    "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " &  Concat(
                       Formularios_QuestionList.AllItems,
                        AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & Q99_Txt_EditReason.Text & ""
                    ),""
                ),
                ""
            );
            //-------------------------------------------------------------------------------------------------------------------RESULTADO
            Switch(
                First(varResponse).ResponseID,
                100,
            //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                If(
                    (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
            //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                            Collect(colBlobMedia,
                            AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" &
                                Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name &Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                      ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature" & Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                );
                //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                If(
                    varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                    //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ) ,
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name  & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                     ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss")   & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                );
                //--------Save Blob Path in SQL DSF_Form_Attachment Table-----------------------------------------
                
                Set(varResponseSAS,Blank());
                If(CountRows(colBlobMedia)>=1,
                Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
                If(CountRows(varResponseSAS)>=1,
                Back(
                    ScreenTransition.Fade
                ),
                
                //-------------------------------------------------------Navega a la ventana principal
            Back(
                    ScreenTransition.Fade
                ));
            
                //-------------------------------------------------------Notifica en pantalla
            Notify(
                    First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                    NotificationType.Success
                );
                ,
                200,
                Notify(
                    "System error! Please try again",
                    NotificationType.Error
                ),//------------------------------------------Cambiar mensaje
                Notify(
                    "Please try again!",
                    NotificationType.Warning
                )//-----------------------------------------------------------Cambiar mensaje
            );
            UpdateContext({varLoadingVisible: false});
            )
        PressedBorderColor: =
        PressedColor: =
        PressedFill: =
        Size: =24
        Text: =""
        Tooltip: =First(collAppLanguage).Lbl_RightButton_2
        Width: =95
        X: =(Parent.Width*2/4) - (Self.Width/2)
        Y: =Parent.Height - Self.Height
        ZIndex: =24

    Formularios_Footer As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =32

        Formularios_Footer_Shp_Background As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Parent.Height * 0.08
            Width: =Parent.Width
            Y: =Parent.Height - Self.Height
            ZIndex: =14

        Formularios_Footer_Icon_Pending As icon.Add:
            Color: =If(VarPendingIndicatorTimer,RGBA(152, 208, 70, 1),RGBA(40, 60, 97, 1))
            DisabledColor: =RGBA(202, 202, 202, 1)
            DisplayMode: |-
                =If(Or(varCompleteReader, Pr_ReviewMode = 1),
                DisplayMode.Disabled,
                DisplayMode.Edit)
            FocusedBorderThickness: =3
            Height: =Formularios_Footer_Shp_Background.Height * 0.6 
            Icon: =Icon.Information
            OnSelect: =
            Tooltip: ="Configuracin"
            Width: =stIconWidth
            X: =(Parent.Width/4) - (Formularios_Footer_Icon_Pending.Width/2)
            Y: =Formularios_Footer_Shp_Background.Y + Formularios_Footer_Shp_Background.Height * 0.1
            ZIndex: =15

        Formularios_Footer_Icon_Submit As icon.Add:
            Color: =RGBA(40, 60, 97, 1)
            DisabledColor: =RGBA(202, 202, 202, 1)
            DisplayMode: |+
                =With({ 
                  all_items: Formularios_QuestionList.AllItems} ,
                  If(Pr_ReviewMode = 0 And (CountRows(all_items) = CountRows(
                        Filter(
                            all_items,
                            Debug_Lbl_Status.Text = "OK"
                        )
                    )) And !varCompleteReader And (CountRows(
                Filter(all_items,fa_answer_type_in = 13 And fa_question_required_bt ,
                lbl_IsTableEmpty.Text="true"))<1), DisplayMode.Edit, DisplayMode.Disabled)
                )
                
            Height: =Formularios_Footer_Shp_Background.Height * 0.6 
            Icon: =Icon.Save
            OnSelect: =
            Tooltip: ="Configuracin"
            Width: =stIconWidth
            X: =(Parent.Width*3/4) - (Formularios_Footer_Icon_Pending.Width/2)
            Y: =Formularios_Footer_Shp_Background.Y + Formularios_Footer_Shp_Background.Height * 0.1
            ZIndex: =16

        Formularios_Footer_Lbl_Submit As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(130, 141, 158, 1)
            DisplayMode: |-
                =If(Pr_ReviewMode = 0 And CountRows(Formularios_QuestionList.AllItems) = CountRows(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Debug_Lbl_Status.Text = "OK"
                        )
                    ), DisplayMode.Edit, DisplayMode.Disabled)
            Font: =stFontType
            FontWeight: =FontWeight.Lighter
            Height: =17
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =First(collAppLanguage).Lbl_RightNav_1
            VerticalAlign: =VerticalAlign.Top
            Width: =74
            X: =Formularios_Footer_Icon_Submit.X + (Formularios_Footer_Icon_Submit.Width/2) - (Formularios_Footer_Lbl_Submit.Width/2)
            Y: =Parent.Height - Self.Height - Formularios_Footer_Icon_Submit.Height * 0.1
            ZIndex: =17

        Formularios_Footer_Lbl_Pending As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 1)
            Color: =RGBA(130, 141, 158, 1)
            DisplayMode: |-
                =If(Or(varCompleteReader, Pr_ReviewMode = 1),
                DisplayMode.Disabled,
                DisplayMode.Edit)
            Font: =stFontType
            FontWeight: =FontWeight.Lighter
            Height: =17
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =First(collAppLanguage).Formularios_Footer_Lbl_Pending
            VerticalAlign: =VerticalAlign.Top
            Width: =74
            X: =Formularios_Footer_Icon_Pending.X+(Formularios_Footer_Icon_Pending.Width/2) - (Formularios_Footer_Lbl_Pending.Width/2)
            Y: =Parent.Height - Self.Height - Formularios_Footer_Icon_Pending.Height * 0.1
            ZIndex: =18

        Formularios_Footer_Btn_Submit As button:
            AutoDisableOnSelect: =false
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =0
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: |+
                =With({ 
                  all_items: Formularios_QuestionList.AllItems} ,
                  If(Pr_ReviewMode = 0 And (CountRows(all_items) = CountRows(
                        Filter(
                            all_items,
                            Debug_Lbl_Status.Text = "OK"
                        )
                    )) And !varCompleteReader And (CountRows(
                Filter(all_items,fa_answer_type_in = 13 And fa_question_required_bt ,
                lbl_IsTableEmpty.Text="true"))<1), DisplayMode.Edit, DisplayMode.Disabled)
                )
                
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Formularios_Footer_Shp_Background.Height
            HoverBorderColor: =
            HoverFill: =
            OnSelect: |-
                =UpdateContext({varActiveLevel:First(collAnswers).fa_active_level});
                UpdateContext({varLastLevel:First(collAnswers).fa_total_question_level});
                Clear(colOutofRange);
                ForAll(Filter(Formularios_QuestionList.AllItems,fa_answer_type_in = 2) As Record,
                If(
                Value(
                        If(
                            IsBlank(Record.Q02_Txt_NumericInput.Text),
                            0,
                            Record.Q02_Txt_NumericInput.Text
                        )
                    ) > Record.fa_answer_max_dc Or Value(
                        If(
                            IsBlank(Record.Q02_Txt_NumericInput.Text),
                            0,
                            Record.Q02_Txt_NumericInput.Text
                        )
                    ) < Record.fa_answer_min_dc,Collect(colOutofRange,{Question:Record.fa_question_description_vc ,Input:Record.Q02_Txt_NumericInput.Text,MinValue:Record.fa_answer_min_dc,MaxValue:Record.fa_answer_max_dc})));
                    
                If(CountRows(colOutofRange)>0,UpdateContext({varConfirmPopup:true});UpdateContext({varSaveType:"Final"}),
                UpdateContext({varLoadingVisible: true});
                UpdateContext({vasStartTimerEvaluate: true});
                UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
                UpdateContext({varPO: " - PO: " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer.Text)});
                UpdateContext({varCIPObject: " - CIP Object: (" & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "2")).Debug_Lbl_Answer.Text) & ") " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "3")).Debug_Lbl_Answer.Text)});
                UpdateContext({varMicroObject: " - CIP Object: (" & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "3")).Debug_Lbl_Answer.Text) & ") " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "4")).Debug_Lbl_Answer.Text)});
                
                //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
                Clear(varResponse);
                Clear(colBlobMedia);
                ClearCollect(
                    varResponse,
                    fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        Concat(
                           Formularios_QuestionList.AllItems As Item ,
                            Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                        ),
                        varFormNum,
                        Pr_DateFilteDT,
                        1,
                        If(varUserEmisorReceptor,1,0),
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),If(varFormType = 2,First(coltestanswere).fa_active_level+1,1),If(varFormType = 2,First(coltestanswere).fa_total_question_level,1)
                    )
                );
                //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
                If(
                    varDebugBit = 1 And !IsBlank(varDebugEmail),
                    Send_Team_Messagev2.Run(
                        varDebugEmail,
                        "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " &  Concat(
                           Formularios_QuestionList.AllItems,
                            AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & If(ThisRecord.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=ThisRecord.fa_question_pos_in && fa_child_pos_in=ThisRecord.fa_child_pos_in,fa_Edit_Reason), Q99_Txt_EditReason.Text) & ""
                        ),""
                    ),
                    ""
                );
                //-------------------------------------------------------------------------------------------------------------------RESULTADO
                Switch(
                    First(varResponse).ResponseID,
                    100,
                    //-------------------------------------------------------Busca los usuarios a notificar
                    UpdateContext(
                        {
                            varUserEmails: LookUp(
                                'dsf.form_level_desc',
                                nu_form_number_vc = Pr_FormNumber And nu_plant_id_in = varPlantId And nu_user_level=varActiveLevel+1
                            ).nu_users_email_tx
                        }
                    );
                    //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                If(
                        (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
                //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & 
                                    Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & 
                                    "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & ""& 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                         ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        ));
                        //-------------------------------------------------------Enva los Teams a cada usuario
                        /*If(!IsBlank(varUserEmail),Send_Team_Messagev2.Run(varUserEmail,First(collAppLanguage).Btn_RightButton_06_MSG04 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG05 & " " & User().FullName & If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))),""))*/
                        
                   If(varFormType = 2 And (IsBlank(varIsFormRequest.fr_status_in) || (Len(varIsFormRequest.fr_status_in)<1) || varIsFormRequest.fr_status_in=-1 ),
                
                                Send_Team_Messagev2.Run(
                            varUserEmails,
                            " The form has been submitted,"&"<br><br>"& 
                            "<b style=""font-weight: 600;"">Document Number:</b> "&Pr_FormNumber&"" &"<br>"&
                            "<b  style=""font-weight: 600;"">Document Name:</b> "&""&Pr_FormDescription&"" &   
                            If(varFrequecyType = "PO",  "<br><b style=""font-weight: 600;"">"&Substitute(varPO,"-","")&"</b>",If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))) & "<br>"&
                            "<b style=""font-weight: 600;"">Submitted by: </b>" & " " & User().FullName &
                            "<br><br> and is now available for you at <b style=""font-weight: 600;"">Level-"&varActiveLevel+1&"</b>.<br><br> Please visit " & "<a href='"&LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId,cnf_mobile_app_link)&"&screen=form&FN="&Pr_FormNumber&"&RD="&Pr_DateFilterIn&"'>Digital Standard Forms</a>"&" to access the request."
                        ,""));
                    
                    //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                If(
                        varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                        //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ) ,
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        );
                        //-------------------------------------------------------Busca quien creo el request (Emisor)
                UpdateContext(
                            {
                                varOwnerRequest: LookUp(
                                    'dsf.form_request_report',
                                    fr_form_number_vc = Pr_FormNumber And fr_planta_id_in = varPlantId And fr_reportdate_dt = Pr_DateFilteDT
                                ).createdby_email
                            }
                        );
                UpdateContext(
                            {
                                varOwnerDisplayNameRequest: LookUp(
                                    'dsf.form_request_report',
                                    fr_form_number_vc = Pr_FormNumber And fr_planta_id_in = varPlantId And fr_reportdate_dt = Pr_DateFilteDT
                                ).createdby_dispname
                            }
                        );
                        //-------------------------------------------------------Enva los Teams a todas las partes (Usuarios a notificar) 
                        If(!IsBlank(varUserEmails), If( varActiveLevel=varLastLevel,
                Send_Team_Messagev2.Run(
                            varUserEmails,
                            First(collAppLanguage).Btn_RightButton_06_MSG01 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG02 & " " & varOwnerDisplayNameRequest & " " & First(collAppLanguage).Btn_RightButton_06_MSG03 & " " & User().FullName &        
                            If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,"")))
                        ,""), Send_Team_Messagev2.Run(
                            varUserEmails,
                            
                           " The form has been submitted,"&"<br><br>"& 
                            "<b style=""font-weight: 600;"">Document Number:</b> "&Pr_FormNumber&"" &"<br>"&
                            "<b  style=""font-weight: 600;"">Document Name:</b> "&""&Pr_FormDescription&"" &   
                            If(varFrequecyType = "PO",  "<br><b style=""font-weight: 600;"">"&Substitute(varPO,"-","")&"</b>",If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))) & "<br>"&
                            "<b style=""font-weight: 600;"">Submitted by: </b>" & " " & User().FullName &
                           "<br><br> and is now available for you at <b style=""font-weight: 600;"">Level-"&varActiveLevel+1&"</b>.<br><br> Please visit " & "<a href='"&LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId,cnf_mobile_app_link)&"&screen=form&FN="&Pr_FormNumber&"&RD="&Pr_DateFilterIn&"'>Digital Standard Forms</a>"&" to access the request."
                        ,"")));
                        //-------------------------------------------------------Enva el Teams a la persona que creo el request
                        If(!IsBlank(varOwnerRequest) And varActiveLevel=varLastLevel && varUserEmail<>varOwnerRequest,
                Send_Team_Messagev2.Run(
                            varOwnerRequest,
                            First(collAppLanguage).Btn_RightButton_06_MSG01 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG02 & " " & varOwnerDisplayNameRequest & " " & First(collAppLanguage).Btn_RightButton_06_MSG03 & " " & User().FullName &        
                            If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,"")))
                        ,""));
                    );
                    //-------------------------------------------------------Navega a la ventana principal
                fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        "",
                        varFormNum,
                        Pr_DateFilteDT,
                        99,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                    );
                    //--------Save Blob Path in SQL DSF_Form_Attachment Table-----------------------------------------
                   If(CountRows(colBlobMedia)>=1,
                    Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
                    If(CountRows(varResponseSAS)>=1,
                    Back(
                        ScreenTransition.Fade
                    ),
                    Back(
                        ScreenTransition.Fade
                    ));
                    
                    //-------------------------------------------------------Notifica en pantalla
                Notify(
                        First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                        NotificationType.Success
                    );
                    ,
                    200,
                    Notify("System error! Please try again",NotificationType.Error),//------------------------------------------Cambiar mensaje
                    Notify("Please try again!",NotificationType.Warning)//-----------------------------------------------------------Cambiar mensaje
                );
                UpdateContext({varLoadingVisible: false});
                )
                
                 
            PressedBorderColor: =
            PressedColor: =
            PressedFill: =
            Size: =24
            Text: =""
            Tooltip: =First(collAppLanguage).Lbl_RightButton_2
            Width: =95
            X: =(Parent.Width*3/4) - (Self.Width/2)
            Y: =Parent.Height - Self.Height
            ZIndex: =20

        Formularios_Footer_Shp_ProgressBar As rectangle:
            Fill: |-
                =If(CountRows(
                    Filter(
                        Formularios_QuestionList.AllItems,
                        Debug_Lbl_Status.Text = "OK"
                    )
                ) = CountRows(Formularios_QuestionList.AllItems),RGBA(152, 208, 70, 1),RGBA(25, 178, 209, 1))
            Height: =5
            Width: |-
                =Parent.Width * (CountRows(
                    Filter(
                        Formularios_QuestionList.AllItems,
                        Debug_Lbl_Status.Text = "OK"
                    )
                ) / CountRows(Formularios_QuestionList.AllItems))
            Y: =Parent.Height - Formularios_Footer_Shp_ProgressBar.Height
            ZIndex: =21

        Formularios_Footer_Btn_Pending As button:
            AutoDisableOnSelect: =false
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderThickness: =0
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: |-
                =If(Or(varCompleteReader, Pr_ReviewMode = 1),
                DisplayMode.Disabled,
                DisplayMode.Edit)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Formularios_Footer_Shp_Background.Height
            HoverBorderColor: =
            HoverFill: =
            OnSelect: |-
                =Reset(Formularios_Other_Tmr_PendingActive);
                UpdateContext({VarPendingIndicatorTimer:true})
            PressedBorderColor: =
            PressedColor: =
            PressedFill: =
            Size: =24
            Text: =""
            Tooltip: =
            Width: =95
            X: =(Parent.Width/4) - (Self.Width/2)
            Y: =Parent.Height - Self.Height
            ZIndex: =34

    Formularios_Header As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =33

        Formularios_Header_Shp_NavBarTop As htmlViewer:
            Height: =202
            HtmlText: |-
                ="<div style ='
                
                  margin-top:0px;
                  margin-bottom:3px;
                  margin-left:0px;
                  margin-right:0px;
                  width: "& Formularios_Header_Shp_NavBarTop.Width &"px;
                  height: "& Formularios_Header_Shp_NavBarTop.Height - 21 &"px;
                  background-color: #3BA5A8;
                  box-shadow: rgba(0, 0, 0, 0.15) 3px 6px 18px;'
                  <center>
                  </center>
                  </div>
                "//rgba(203, 16, 18, 1)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Width: =Parent.Width
            ZIndex: =4

        Formularios_Header_Lbl_ScreenTitle As label:
            Color: =RGBA(255, 255, 255, 1)
            Font: =//"Arial Rounded MT"
            Height: =60
            Size: =30
            Text: =Pr_FormNumber 
            Width: =Parent.Width - 60
            Wrap: =false
            X: =30
            Y: =Formularios_Header_Lbl_ScreenSubTitle.Y - Self.Height-2
            ZIndex: =7

        Formularios_Header_Lbl_ScreenSubTitle As label:
            Color: =RGBA(241, 244, 249, 1)
            Font: ="Unity"
            FontWeight: =FontWeight.Lighter
            Height: =29
            Overflow: =Overflow.Scroll
            PaddingBottom: =0
            PaddingTop: =0
            Size: =11
            Text: =Pr_FormDescription & If(Pr_ReviewMode = 1, " (Review Process)", "") 
            Width: =Parent.Width - 60
            X: =30
            Y: =Formularios_Header_Shp_NavBarTop.Height - Self.Height - 25
            ZIndex: =8

        Formularios_Header_Btn_Notification As icon.Filter:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =0
            Height: =49
            Icon: =Icon.Bell
            OnSelect: =
            Tooltip: ="Pending Task"
            Width: =59
            X: =Parent.Width - Self.Width - 30
            Y: =33
            ZIndex: =9

        Formularios_Header_Btn_Return As icon.Filter:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =0
            Height: =49
            Icon: =Icon.ArrowLeft
            OnSelect: |-
                =
                    fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        "",
                        varFormNum,
                        Pr_DateFilteDT,
                        99,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                    );
                    Back(ScreenTransition.Fade)
            Width: =59
            X: =30
            Y: =33
            ZIndex: =10

        Formularios_Header_Shp_PendingIndicator As circle:
            BorderColor: =RGBA(220, 153, 153, 1)
            BorderThickness: =2
            Fill: =RGBA(203, 102, 102, 1)
            Height: =28
            OnSelect: =
            Visible: =If(TotalPending = 0 Or IsBlankOrError(TotalPending),false,true)
            Width: =28
            X: =Parent.Width - Self.Width - 30
            Y: =30
            ZIndex: =11

        Formularios_Header_Lbl_PendingIndicator As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Font: =
            FontWeight: =FontWeight.Bold
            Height: =28
            OnSelect: =
            Size: =10
            Text: |-
                =//----------------------------------------------------------------------------------------------------MUESTRA CANTIDAD DE PENDIENTES
                If(TotalPending > 9,"+9",TotalPending)
            Visible: =If(TotalPending = 0 Or IsBlankOrError(TotalPending),false,true)
            Width: =28
            X: =Parent.Width - Self.Width - 30
            Y: =30
            ZIndex: =12

        Formularios_Header_Btn_Refresh As icon.Filter:
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =0
            Height: =49
            Icon: =Icon.Reload
            OnSelect: =
            Tooltip: ="Refresh"
            Width: =59
            X: =Formularios_Header_Btn_Notification.X - Self.Width - 30
            Y: =33
            ZIndex: =13

        Formularios_Header_Tmr_LoadingScreen As timer:
            BorderColor: =
            BorderThickness: =0
            Color: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =
            DisabledColor: =
            DisabledFill: =
            Duration: =varTimerQuestion
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Bold
            Height: =Formularios_Header_Btn_Refresh.Height
            HoverBorderColor: =
            HoverColor: =RGBA(0, 0, 0, 0)
            HoverFill: =
            OnTimerEnd: |+
                =UpdateContext({varLoadingVisible: true});
                    //UpdateContext({varBlobItems: false});
                Refresh('dsf.answers_report');
                Refresh('dsf.answers_report_release_process');
                Refresh('dsf.form_answer_attachment');
                Clear(varTableAnswers);
                ClearCollect(colformAnswerAttachment,ShowColumns(Filter('dsf.form_answer_attachment',Pr_FormNumber in faa_path_vc,faa_date_vc=Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T","")),faa_path_vc,faa_sas_vc,faa_date_vc,faa_item_vc,faa_child_pos));
                Reset(Q15_Signature_PenInput);
                ClearCollect(ColSignatures,ShowColumns(AddColumns(Filter(Formularios_QuestionList.AllItems,fa_answer_type_in=15),InitialImage,""),fa_question_pos_in,fa_child_pos_in,InitialImage));
                Set(
                    varFormNum,
                    If(
                        Pr_ReviewMode = 1,
                        Pr_FormNumber & "_Review",
                        Pr_FormNumber
                    )
                );
                ClearCollect(
                    Source,
                    If(
                        Pr_ReviewMode = 1,
                            /*Filter(
                                'dsf.answers_report_release_process',
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn,
                                fq_question_enable_bt = true
                            )*/
                        fa_GetReport.Run(
                            varFormNum,
                            Pr_DateFilterIn,
                            "2023-07-19 06:51:47.000",
                            varPlantId,
                            0
                        ),
                            /*Filter(
                            'dsf.answers_report',
                            fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn,
                            fq_question_enable_bt = true
                        )*/
                        fa_GetReport.Run(
                            varFormNum,
                            Pr_DateFilterIn,
                            "2023-07-19 06:51:47.000",
                            varPlantId,
                            1
                        )
                    )
                );
                
                ClearCollect(
                    collAllAnswers,
                    If(
                        And(
                            varFormType = 2,//---Form Confirmation
                            varUserEmisorReceptor = false,//---Emisor
                            Pr_ReviewMode = 0
                        ),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn And 1 in Split(fa_user_type,";")//---Muestra solo las preguntas Emisor
                            ),
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending),
                         And(
                            varUserEmisorReceptor = false,//---Emisor
                            Pr_ReviewMode = 1
                        ),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn 
                            ),
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn And Min(Int(Split(fa_user_type,";")),Value)<=fa_active_level) 
                            ,
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending)
                    )
                );
                //Row counter
                ClearCollect(
                    rowCounter,
                    {Value: 1}
                );
                Clear(collAnswers);
                ForAll(
                    Filter(
                        collAllAnswers,
                        Upper(fa_form_number_vc) = Upper(varFormNum) And fa_report_date_in = Pr_DateFilterIn
                    ) As Row,
                    Collect(
                        collAnswers,
                        {
                            RowNum: First(rowCounter).Value,
                            fat_question_pos_in: Row.fat_question_pos_in,
                            fa_answer_characters_in: Row.fa_answer_characters_in,
                            fa_answer_list_vc: Row.fa_answer_list_vc,
                            fa_answer_max_dc: Row.fa_answer_max_dc,
                            fa_answer_min_dc: Row.fa_answer_min_dc,
                            fa_answer_type_in: Row.fa_answer_type_in,
                            fa_form_number_vc: Row.fa_form_number_vc,
                            fa_plant_id_in: Row.fa_plant_id_in,
                            fa_answer_numeric_in: Row.fa_answer_numeric_in,
                            fa_answer_text_vc: Row.fa_answer_text_vc,
                            fa_answer_bit_bt: Row.fa_answer_bit_bt,
                            fa_answer_date_dt: Row.fa_answer_date_dt,
                            fa_label_off_vc: Row.fa_label_off_vc,
                            fa_label_on_vc: Row.fa_label_on_vc,
                            fa_question_description_vc: Row.fa_question_description_vc,
                            fa_question_pos_in: Row.fa_question_pos_in,
                            fa_question_required_bt: Row.fa_question_required_bt,
                            fa_title_description_vc: Row.fa_title_description_vc,
                            fa_title_hide_bt: Row.fa_title_hide_bt,
                            fa_title_name_vc: Row.fa_title_name_vc,
                            fa_question_equipment_bt: Row.fa_question_equipment_bt,
                            fa_equipment_id_in: Row.fa_equipment_id_in,
                            fa_comment_vc: Row.fa_comment_vc,
                            fq_question_type_bt: Row.fq_question_type_bt,
                            fa_active_level: Row.fa_active_level,
                            fa_user_type: Row.fa_user_type,
                            fa_total_question_level: Row.fa_total_question_level,
                            fa_requested_user: Row.fa_requested_user,
                            fa_child_criteria: Row.fa_child_criteria,
                            fa_child_pos_in: Row.fa_child_pos_in,
                            temp_answer2: If(
                                Row.fa_child_pos_in = 0,
                                Switch(
                                    Row.fa_answer_type_in,
                                    1, If(
                                            Row.fa_answer_text_vc = Row.fa_label_on_vc,
                                            "true",
                                            "false"
                                        ),
                                    2,
                                    If(
                                        IsBlank(Value(Row.fa_answer_numeric_in)),
                                        "notApplicable",
                                        Value(Row.fa_answer_numeric_in) <= Value(Row.fa_answer_max_dc) && Value(Row.fa_answer_numeric_in) >= Value(Row.fa_answer_min_dc),
                                        "Within Range",
                                        "Out of Range"
                                    ),
                                    6,
                                    Row.fa_answer_text_vc,
                                    12,
                                    Row.fa_answer_text_vc
                                )
                            ),
                            IsActive: If(
                                Row.fa_child_pos_in = 0,
                                true,
                                With(
                                    {
                                        ParentAnswer: LookUp(
                                            collAllAnswers,
                                            fa_child_pos_in = 0 && fa_question_pos_in = Row.fa_question_pos_in
                                        )
                                    },
                                    Switch(
                                        ParentAnswer.fa_answer_type_in,
                                        1,
                                        If(
                                            ParentAnswer.fa_answer_text_vc = ParentAnswer.fa_label_on_vc,
                                            "true",
                                            "false"
                                        ),
                                        2,
                                        If(
                                            IsBlank(Value(Row.fa_answer_text_vc)),
                                            "notApplicable",
                                            Value(ParentAnswer.fa_answer_text_vc) <= Value(ParentAnswer.fa_answer_max_dc) && Value (ParentAnswer.fa_answer_text_vc) >= Value(ParentAnswer.fa_answer_min_dc),
                                            "Within Range",
                                            "Out of Range"
                                        ),
                                        6,
                                        ParentAnswer.fa_answer_text_vc,
                                        12,
                                        ParentAnswer.fa_answer_text_vc
                                    ) in Trim(Text(Row.fa_child_criteria))
                                ),
                                true,
                                false
                            )
                            
                        }
                    );
                    Patch(
                        rowCounter,
                        First(rowCounter),
                        {
                            Value: First(
                                Sort(
                                    collAnswers,
                                    RowNum,
                                    SortOrder.Descending
                                )
                            ).RowNum + 1
                        }
                    );
                    If(
                        And(
                            CountRows(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = Row.fa_question_pos_in,
                                    ChildPos= Row.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ) = 0,
                            Row.fa_answer_type_in = 13
                        ),
                        Collect(
                            varTableAnswers,
                            {
                                Resultado: Row.fa_answer_text_vc,
                                AnsPos: Row.fa_question_pos_in,
                                ChildPos: Row.fa_child_pos_in,
                                ReportDate: Pr_DateFilterIn
                            }
                        ),
                        Update(
                            varTableAnswers,
                            First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = Row.fa_question_pos_in,
                                    ChildPos= Row.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ),
                            {
                                Resultado: Row.fa_answer_text_vc,
                                AnsPos: Row.fa_question_pos_in,
                                ChildPos: Row.fa_child_pos_in,
                                ReportDate: Pr_DateFilterIn
                            }
                        )
                    )
                );
                UpdateContext(
                    {
                        varMaxCollAnswer: Max(
                            collAnswers,
                            RowNum
                        )
                    }
                );
                Set(
                    varNextAnswer,
                    1
                );
                UpdateContext({VarTimerStart: false});
                If(
                    CountRows(Formularios_QuestionList.AllItems) = 0,
                    UpdateContext({VarTimerStart: true}),
                    UpdateContext({varLoadingVisible: false});
                    
                );
                
                
                ClearCollect(
                    coltestanswere,
                    AddColumns(
                        collAnswers,
                        questionNumberNew,
                        RowNum
                    )
                );
                ClearCollect(coltestanswere2,collAnswers);
                
                Set(
                    loopcompleted,
                    false
                );
                UpdateContext({varActiveLevel: First(collAnswers).fa_active_level});
                UpdateContext({varLastLevel: First(collAnswers).fa_total_question_level});
                //-----------------------------Determina si es necesario evaluar el formulario
                If(
                    VarEvaluateForm = true,
                    UpdateContext({vasStartTimerEvaluate: true}),
                    UpdateContext({vasStartTimerEvaluate: false})
                );
                If(
                    Max(
                        Formularios_QuestionList.AllItems,
                        Value(Label15.Text)
                    ) <> Formularios_QuestionList.TemplateHeight,
                    Reset(Slider1)
                );
                Clear(Q11_TemporalPictures);
                UpdateContext({varResetReason: true});
                UpdateContext({varResetReason: false});
                UpdateContext({varParenttmr:false});
                UpdateContext({varParenttmr:true});
                
                
            OnTimerStart: |-
                = UpdateContext({varLoadingVisible: true});
            PressedBorderColor: =
            PressedColor: =
            PressedFill: =
            Start: =VarTimerStart
            Text: =Self.Value*100/Self.Duration & " %"
            Width: =Formularios_Header_Btn_Refresh.Width
            X: =Formularios_Header_Btn_Refresh.X
            Y: =Formularios_Header_Btn_Refresh.Y
            ZIndex: =33

    Formularios_CloseMessage As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =34

        Formularios_CloseMessage_Shp_Background As rectangle:
            DisabledFill: =Formularios_CloseMessage_Shp_Background.Fill
            Fill: =RGBA(96, 96, 98, 0.64)
            FocusedBorderColor: =Formularios_CloseMessage_Shp_Background.BorderColor
            Height: =Parent.Height
            HoverFill: =Formularios_CloseMessage_Shp_Background.Fill
            OnSelect: =
            PressedFill: =Formularios_CloseMessage_Shp_Background.Fill
            Visible: =varShowDialog
            Width: =Parent.Width
            ZIndex: =25

        Formularios_CloseMessage_Shp_BackgroundMessage As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: |
                =Formularios_CloseMessage_Shp_Accept.Y + Formularios_CloseMessage_Shp_Accept.Height - Self.Y + 30
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:1;background-color:#FFFFFF;box-shadow:0 3px 6px 1px  #ccc; border-radius:8px'></div>"
            Visible: =varShowDialog
            Width: =Parent.Width * 0.9
            X: =(Parent.Width - Self.Width)/2
            Y: =Parent.Height/2 - 300
            ZIndex: =26

        Formularios_CloseMessage_Shp_Accept As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =90
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:0.8;background-color:#F0F0F0;box-shadow:0 3px 6px 1px  #ccc; border-radius:90px'></div>"
            OnSelect: =
            Visible: =varShowDialog
            Width: =(Formularios_CloseMessage_Shp_BackgroundMessage.Width/2) *0.8
            X: =Accion_AcquireForm_Lbl_AcquireMessage.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription.Y + Formularios_CloseMessage_Lbl_CloseDescription.Height + 15 
            ZIndex: =27

        Formularios_CloseMessage_Shp_Cancel As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =90
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:0.8;background-color:#F0F0F0;box-shadow:0 3px 6px 1px  #ccc; border-radius:90px'></div>"
            OnSelect: =
            Visible: =varShowDialog
            Width: =(Formularios_CloseMessage_Shp_BackgroundMessage.Width/2) *0.8
            X: =Accion_AcquireForm_Lbl_AcquireMessage.X + Accion_AcquireForm_Lbl_AcquireMessage.Width - Self.Width
            Y: =Formularios_CloseMessage_Lbl_CloseDescription.Y + Formularios_CloseMessage_Lbl_CloseDescription.Height + 15 
            ZIndex: =28

        Formularios_CloseMessage_Btn_Cancel As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(40, 60, 97, 1)
            Font: ="U"
            Height: =Formularios_CloseMessage_Shp_Cancel.Height
            OnSelect: |-
                =UpdateContext({varShowDialog: false});
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =20
            Text: =First(collAppLanguage).'Question Cancel Button Screen 6'
            Visible: =varShowDialog
            Width: =Formularios_CloseMessage_Shp_Cancel.Width
            X: =Formularios_CloseMessage_Shp_Cancel.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription.Y + Formularios_CloseMessage_Lbl_CloseDescription.Height + 15 
            ZIndex: =29

        Formularios_CloseMessage_Btn_Accept As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(40, 60, 97, 1)
            Font: ="U"
            Height: =Formularios_CloseMessage_Shp_Accept.Height
            OnSelect: |-
                =If(varFormMode<>FormMode.Edit,
                fa_AnswerReport.Run(
                        "",
                        "",
                        User().Email,
                        If(varUserEmisorReceptor = false ,"Delete",true),
                        Text(Pr_FormNumber),
                        "",
                        "",
                        "",
                        "",
                        "",
                        Pr_DateFilteDT,
                        If(IsBlank(Q99_Txt_Notes.Text),"",Q99_Txt_Notes.Text),
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        varPlantId,
                        1,
                        0,
                        0,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),varActiveLevel);
                UpdateContext({varShowDialog: false});
                Back(ScreenTransition.Fade),fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        "",
                        varFormNum,
                        Pr_DateFilteDT,
                        99,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                    );
                    Back(ScreenTransition.Fade));
                    Set(AutoSave,true);
                Set(AutoSave,false);
                //Navigate('08_ACCIN',ScreenTransition.Fade)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =20
            Text: =First(collAppLanguage).Btn_LeftBtn_1
            Visible: =varShowDialog
            Width: =Formularios_CloseMessage_Shp_Accept.Width
            X: =Formularios_CloseMessage_Shp_Accept.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription.Y + Formularios_CloseMessage_Lbl_CloseDescription.Height + 15 
            ZIndex: =30

        Formularios_CloseMessage_Lbl_CloseDescription As label:
            Align: =Align.Center
            AutoHeight: =true
            Color: =RGBA(45, 45, 45, 1)
            FocusedBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription.BorderColor
            Font: ="Unity"
            Height: =174
            HoverBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription.BorderColor
            HoverColor: =Formularios_CloseMessage_Lbl_CloseDescription.Color
            HoverFill: =Formularios_CloseMessage_Lbl_CloseDescription.Fill
            OnSelect: =
            PressedBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription.BorderColor
            PressedColor: =Formularios_CloseMessage_Lbl_CloseDescription.Color
            PressedFill: =Formularios_CloseMessage_Lbl_CloseDescription.Fill
            Size: =21
            Text: =First(collAppLanguage).'Question SubTitle Screen 6'
            VerticalAlign: =VerticalAlign.Top
            Visible: =varShowDialog
            Width: =Formularios_CloseMessage_Shp_BackgroundMessage.Width * 0.9
            X: =(Parent.Width-Formularios_CloseMessage_Lbl_CloseDescription.Width)/2
            Y: =Formularios_CloseMessage_Lbl_CloseTitle.Y + Formularios_CloseMessage_Lbl_CloseTitle.Height + 15
            ZIndex: =31

        Formularios_CloseMessage_Lbl_CloseTitle As label:
            Align: =Align.Center
            AutoHeight: =true
            FocusedBorderColor: =Formularios_CloseMessage_Lbl_CloseTitle.BorderColor
            Font: =
            FontWeight: =FontWeight.Bold
            Height: =44
            HoverBorderColor: =Formularios_CloseMessage_Lbl_CloseTitle.BorderColor
            HoverColor: =Formularios_CloseMessage_Lbl_CloseTitle.Color
            HoverFill: =Formularios_CloseMessage_Lbl_CloseTitle.Fill
            OnSelect: =
            PressedBorderColor: =Formularios_CloseMessage_Lbl_CloseTitle.BorderColor
            PressedColor: =Formularios_CloseMessage_Lbl_CloseTitle.Color
            PressedFill: =Formularios_CloseMessage_Lbl_CloseTitle.Fill
            Size: =30
            Text: =First(collAppLanguage).'Question Title Screen 6'
            Visible: =varShowDialog
            Width: =Formularios_CloseMessage_Shp_BackgroundMessage.Width * 0.9
            X: =Formularios_CloseMessage_Shp_Accept.X
            Y: =Formularios_CloseMessage_Shp_BackgroundMessage.Y + 25
            ZIndex: =32

    Formularios_Other_Tmr_SaveAnswer As timer:
        Duration: =varTimerSave
        Height: =70
        OnTimerEnd: |-
            =UpdateContext({vasStartTimerEvaluate: false})
        OnTimerStart: =
        Start: =vasStartTimerEvaluate
        Text: =Self.Value*100/Self.Duration & " %"
        Visible: =false
        Width: =280
        X: =165
        Y: =490
        ZIndex: =35

    Formularios_Other_Tmr_PendingActive As timer:
        Height: =70
        OnTimerEnd: |-
            =UpdateContext({VarPendingIndicatorTimer:false});
            Reset(Self)
        Start: =VarPendingIndicatorTimer
        Text: =Self.Value
        Visible: =false
        Width: =280
        X: =40
        Y: =148
        ZIndex: =36

    Formularios_Loading As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =36

        Formularios_Loading_Cmp_Loading As Lir_Loading_1:
            Height: =Parent.Height
            IsLoading: =varLoadingVisible 
            Text: |-
                =First(collAppLanguage).LoadingText & If(
                    Formularios_Header_Tmr_LoadingScreen.Value > 0,
                    Round(
                        Formularios_Header_Tmr_LoadingScreen.Value * 100 / Formularios_Header_Tmr_LoadingScreen.Duration,
                        0
                    ),
                    If(
                        Formularios_Other_Tmr_SaveAnswer.Value > 0,
                        Round(
                            Formularios_Other_Tmr_SaveAnswer.Value * 100 / Formularios_Other_Tmr_SaveAnswer.Duration,
                            0
                        ),
                         If(
                        Formularios_Loading_Tmr_Reset.Value > 0,
                        Round(
                            Formularios_Loading_Tmr_Reset.Value * 100 / Formularios_Loading_Tmr_Reset.Duration,
                            0
                        ),
                        0
                    )    )
                ) & " %"
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =Parent.Width
            ZIndex: =49

        "Formularios_Loading_Icon_Cancel As icon.'3DPrinting'":
            Color: =RGBA(255, 255, 255, 1)
            Height: =Formularios_Footer_Icon_Submit.Height
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =/*fa_AnswerReport.Run(
                        "",
                        "",
                        User().Email,
                        If(varUserEmisorReceptor = false ,"Delete",true),
                        Text(Pr_FormNumber),
                        "",
                        "",
                        "",
                        "",
                        "",
                        Pr_DateFilteDT,
                        "",
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        varPlantId,
                        1,
                        0,
                        0,
                        0);*/
                
                If(
                    Pr_PartialRecord = 1,
                    fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        "",
                        varFormNum,
                        Pr_DateFilteDT,
                        99,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                    );
                    Back(ScreenTransition.Fade),
                    fa_AnswerReport.Run(
                        "",
                        "",
                        User().Email,
                        If(varUserEmisorReceptor = false ,"Delete",true),
                        Text(Pr_FormNumber),
                        "",
                        "",
                        "",
                        "",
                        "",
                        Pr_DateFilteDT,
                        "",
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        0,
                        varPlantId,
                        1,
                        0,
                        0,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),varActiveLevel)
                );
                UpdateContext({varShowDialog: false});
                Navigate('03_ACCIN',ScreenTransition.Fade);
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =Formularios_Footer_Icon_Submit.Width
            X: =Parent.Width/2 + 50
            Y: =Parent.Height/2 + 100
            ZIndex: =50

        Formularios_Loading_Lbl_Cancel As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =17
            Size: =10
            Text: =First(collAppLanguage).Btn_RightBtn
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =74
            X: =Formularios_Loading_Icon_Cancel.X
            Y: =Formularios_Loading_Icon_Cancel.Y + Formularios_Loading_Icon_Cancel.Height + 10
            ZIndex: =51

        "Formularios_Loading_Icon_Reset As icon.'3DPrinting'":
            Color: =RGBA(255, 255, 255, 1)
            Height: =Formularios_Footer_Icon_Submit.Height
            Icon: =Icon.Reload
            OnSelect: =
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =Formularios_Footer_Icon_Submit.Width
            X: =Parent.Width/2 - 100
            Y: =Parent.Height/2 + 100
            ZIndex: =52

        Formularios_Loading_Lbl_Reset As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =17
            Size: =10
            Text: =First(collAppLanguage).Formularios_Loading_Lbl_Reset
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =74
            X: =Formularios_Loading_Icon_Reset.X
            Y: =Formularios_Loading_Icon_Reset.Y + Formularios_Loading_Icon_Reset.Height + 10
            ZIndex: =53

        Formularios_Loading_Tmr_Reset As timer:
            BorderColor: =
            BorderThickness: =0
            Color: =RGBA(0, 0, 0, 0)
            DisabledBorderColor: =
            DisabledColor: =
            DisabledFill: =
            Duration: =varTimerQuestion
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Bold
            Height: =Formularios_Loading_Icon_Reset.Height
            HoverBorderColor: =
            HoverColor: =RGBA(0, 0, 0, 0)
            HoverFill: =
            OnTimerEnd: |
                =
                UpdateContext({varLoadingVisible: true});
                
                Refresh('dsf.answers_report');
                Refresh('dsf.answers_report_release_process');
                Clear(varTableAnswers);
                ClearCollect(colformAnswerAttachment,ShowColumns(Filter('dsf.form_answer_attachment',Pr_FormNumber in faa_path_vc,faa_date_vc=Substitute(Substitute(Substitute(Substitute(Substitute(Pr_DateFilteDT,"/",""),":","")," ",""),"-",""),"T","")),faa_path_vc,faa_sas_vc,faa_date_vc,faa_item_vc,faa_child_pos));
                Reset(Q15_Signature_PenInput);
                ClearCollect(ColSignatures,ShowColumns(AddColumns(Filter(Formularios_QuestionList.AllItems,fa_answer_type_in=15),InitialImage,""),fa_question_pos_in,fa_child_pos_in,InitialImage));
                Set(
                    varFormNum,
                    If(
                        Pr_ReviewMode = 1,
                        Pr_FormNumber & "_Review",
                        Pr_FormNumber
                    )
                );
                ClearCollect(
                    Source,
                    If(
                        Pr_ReviewMode = 1,
                        /*Filter(
                            'dsf.answers_report_release_process',
                            fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn,
                            fq_question_enable_bt = true
                        )*/ fa_GetReport.Run(Pr_FormNumber,Pr_DateFilterIn,"2023-07-19 06:51:47.000",varPlantId,0),
                        /*Filter(
                            'dsf.answers_report',
                            fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn,
                            fq_question_enable_bt = true
                        )*/ fa_GetReport.Run(Pr_FormNumber,Pr_DateFilterIn,"2023-07-19 06:51:47.000",varPlantId,1)
                    )
                );
                
                ClearCollect(
                    collAllAnswers,
                    If(
                        And(
                            varFormType = 2,//---Form Confirmation
                            varUserEmisorReceptor = false,//---Emisor
                            Pr_ReviewMode = 0
                        ),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn And 1 in Split(fa_user_type,";")//---Muestra solo las preguntas Emisor
                            ),
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending),
                         And(
                            varUserEmisorReceptor = false,//---Emisor
                            Pr_ReviewMode = 1
                        ),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn 
                            ),
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending),
                        SortByColumns(
                            Filter(
                                Source,
                                fa_form_number_vc = varFormNum And fa_report_date_in = Pr_DateFilterIn And Min(Int(Split(fa_user_type,";")),Value)<=fa_active_level) 
                            ,
                             "fa_question_pos_in",
                            SortOrder.Ascending,"fa_child_pos_in",SortOrder.Ascending)
                    )
                );
                //Row counter
                ClearCollect(
                    rowCounter,
                    {Value: 1}
                );
                Clear(collAnswers);
                ForAll(
                    Filter(
                        collAllAnswers,
                        Upper(fa_form_number_vc) = Upper(varFormNum) And fa_report_date_in = Pr_DateFilterIn
                    ) As Row,
                    Collect(
                        collAnswers,
                        {
                            RowNum: First(rowCounter).Value,
                            fat_question_pos_in: Row.fat_question_pos_in,
                            fa_answer_characters_in: Row.fa_answer_characters_in,
                            fa_answer_list_vc: Row.fa_answer_list_vc,
                            fa_answer_max_dc: Row.fa_answer_max_dc,
                            fa_answer_min_dc: Row.fa_answer_min_dc,
                            fa_answer_type_in: Row.fa_answer_type_in,
                            fa_form_number_vc: Row.fa_form_number_vc,
                            fa_plant_id_in: Row.fa_plant_id_in,
                            fa_answer_numeric_in: Row.fa_answer_numeric_in,
                            fa_answer_text_vc: Row.fa_answer_text_vc,
                            fa_answer_bit_bt: Row.fa_answer_bit_bt,
                            fa_answer_date_dt: Row.fa_answer_date_dt,
                            fa_label_off_vc: Row.fa_label_off_vc,
                            fa_label_on_vc: Row.fa_label_on_vc,
                            fa_question_description_vc: Row.fa_question_description_vc,
                            fa_question_pos_in: Row.fa_question_pos_in,
                            fa_question_required_bt: Row.fa_question_required_bt,
                            fa_title_description_vc: Row.fa_title_description_vc,
                            fa_title_hide_bt: Row.fa_title_hide_bt,
                            fa_title_name_vc: Row.fa_title_name_vc,
                            fa_question_equipment_bt: Row.fa_question_equipment_bt,
                            fa_equipment_id_in: Row.fa_equipment_id_in,
                            fa_comment_vc: Row.fa_comment_vc,
                            fq_question_type_bt: Row.fq_question_type_bt,
                            fa_active_level: Row.fa_active_level,
                            fa_user_type: Row.fa_user_type,
                            fa_total_question_level: Row.fa_total_question_level,
                            fa_requested_user: Row.fa_requested_user,
                            fa_child_criteria: Row.fa_child_criteria,
                            fa_child_pos_in: Row.fa_child_pos_in,
                            temp_answer2: If(
                                Row.fa_child_pos_in = 0,
                                Switch(
                                    Row.fa_answer_type_in,
                                    1,
                                    If(
                                        Row.fa_answer_text_vc = Row.fa_label_on_vc,
                                        "true",
                                        "false"
                                    ),
                                    2,
                                    If(
                                        IsBlank(Value(Row.fa_answer_numeric_in)),
                                        "notApplicable",
                                        Value(Row.fa_answer_numeric_in) <= Value(Row.fa_answer_max_dc) && Value(Row.fa_answer_numeric_in) >= Value(Row.fa_answer_min_dc),
                                        "Within Range",
                                        "Out of Range"
                                    ),
                                    6,
                                    Row.fa_answer_text_vc,
                                    12,
                                    Row.fa_answer_text_vc
                                )
                            ),
                            IsActive: If(
                                Row.fa_child_pos_in = 0,
                                true,
                                With(
                                    {
                                        ParentAnswer: LookUp(
                                            collAllAnswers,
                                            fa_child_pos_in = 0 && fa_question_pos_in = Row.fa_question_pos_in
                                        )
                                    },
                                    Switch(
                                        ParentAnswer.fa_answer_type_in,
                                        1,
                                        If(
                                            ParentAnswer.fa_answer_text_vc = ParentAnswer.fa_label_on_vc,
                                            "true",
                                            "false"
                                        ),
                                        2,
                                        If(
                                            IsBlank(Value(Row.fa_answer_numeric_in)),
                                            "notApplicable",
                                            Value(ParentAnswer.fa_answer_numeric_in) <= Value(ParentAnswer.fa_answer_max_dc) && Value (ParentAnswer.fa_answer_numeric_in) >= Value(ParentAnswer.fa_answer_min_dc),
                                            "Within Range",
                                            "Out of Range"
                                        ),
                                        6,
                                        ParentAnswer.fa_answer_text_vc,
                                        12,
                                        ParentAnswer.fa_answer_text_vc
                                    ) in Trim(Text(Row.fa_child_criteria))
                                ),
                                true,
                                false
                            )
                        }
                    );
                    Patch(
                        rowCounter,
                        First(rowCounter),
                        {
                            Value: First(
                                Sort(
                                    collAnswers,
                                    RowNum,
                                    SortOrder.Descending
                                )
                            ).RowNum + 1
                        }
                    );
                    If(
                        And(
                            CountRows(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = Row.fa_question_pos_in,
                                    ChildPos= Row.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ) = 0,
                            Row.fa_answer_type_in = 13
                        ),
                        Collect(
                            varTableAnswers,
                            {
                                Resultado: Row.fa_answer_text_vc,
                                AnsPos: Row.fa_question_pos_in,
                                ChildPos: Row.fa_child_pos_in,
                                ReportDate: Pr_DateFilterIn
                            }
                        ),
                        Update(
                            varTableAnswers,
                            First(
                                Filter(
                                    varTableAnswers,
                                    AnsPos = Row.fa_question_pos_in,
                                    ChildPos= Row.fa_child_pos_in,
                                    ReportDate = Pr_DateFilterIn
                                )
                            ),
                            {
                                Resultado: Row.fa_answer_text_vc,
                                AnsPos: Row.fa_question_pos_in,
                                ChildPos: Row.fa_child_pos_in,
                                ReportDate: Pr_DateFilterIn
                            }
                        )
                    )
                );
                UpdateContext(
                    {
                        varMaxCollAnswer: Max(
                            collAnswers,
                            RowNum
                        )
                    }
                );
                Set(
                    varNextAnswer,
                    1
                );
                ClearCollect(coltestanswere55,AddColumns(collAnswers,questionNumberNew,RowNum));
                ClearCollect(coltestanswere,AddColumns(collAnswers,questionNumberNew,RowNum));
                ClearCollect(coltestanswere2,coltestanswere);
                
                Set(loopcompleted,false);
                UpdateContext({varActiveLevel:First(collAnswers).fa_active_level});
                UpdateContext({varLastLevel:First(collAnswers).fa_total_question_level});
                If(
                Max(Formularios_QuestionList.AllItems,Value(Label15.Text))<>Formularios_QuestionList.TemplateHeight,Reset(Slider1));
                
                If(
                    CountRows(Formularios_QuestionList.AllItems) = 0,
                    UpdateContext({VarTimerStart: false});
                    UpdateContext({VarTimerStart: true}),
                    UpdateContext({VarTimerStart: false});
                    UpdateContext({varLoadingVisible: false})   
                );
                UpdateContext({varParenttmr:false});
                UpdateContext({varParenttmr:true});
                
                
                //-----------------------------Determina si es necesario evaluar el formulario
                /*If(
                    VarEvaluateForm = true,
                    UpdateContext({vasStartTimerEvaluate: true}),
                    UpdateContext({vasStartTimerEvaluate: false})
                )*/
            OnTimerStart: |-
                = UpdateContext({varLoadingVisible: true});
            PressedBorderColor: =
            PressedColor: =
            PressedFill: =
            Start: =VarTimerStart && Pr_ReviewMode <> 1
            Text: =Self.Value*100/Self.Duration & " %"
            Visible: =Formularios_Loading_Cmp_Loading.IsLoading
            Width: =Formularios_Loading_Icon_Reset.Width
            X: =Formularios_Loading_Icon_Reset.X
            Y: =Formularios_Loading_Icon_Reset.Y
            ZIndex: =54

    Formularios_Other_Tmr_Blink As timer:
        AutoPause: =false
        AutoStart: =true
        Duration: =1000
        Height: =69
        OnTimerEnd: |-
            =If(VarBlink,UpdateContext({VarBlink:false}),UpdateContext({VarBlink:true}))
        OnTimerStart: =
        Repeat: =true
        Text: =Self.Value
        Visible: =false
        Width: =120
        X: =75
        Y: =34
        ZIndex: =37

    tmr_AutoSave As timer:
        AutoPause: =false
        Duration: |-
            =//LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId).cnf_timer_save_in*60
            varAutoSavingTime
        Height: =65
        OnTimerEnd: |
            =
            
            UpdateContext({varLoadingVisible: true});
            UpdateContext({vasStartTimerEvaluate: true});
            //UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
            //UpdateContext({varPO: First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer});
            
            //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
            Clear(varResponse);
            Clear(colBlobMedia);
            ClearCollect(
                varResponse,
                fa_AnswerReport_Opt.Run(
                    varUserEmail,
                     Concat(
                       Formularios_QuestionList.AllItems As Item ,
                        Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                    ),
                    varFormNum,
                    Pr_DateFilteDT,
                    2,//varFormType,
                    If(
                        varUserEmisorReceptor,
                        1,
                        0
                    ),
                    Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                )
            );
             nf_Update_Form_Requestv2.Run(
                        varPlantId,
                        varFormNum,
                        Pr_DateFilteDT,
                        varUserId,
                        1,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss")
                    );
            //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
            If(
                varDebugBit = 1 And !IsBlank(varDebugEmail),
                Send_Team_Messagev2.Run(
                    varDebugEmail,
                    "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " &  Concat(
                       Formularios_QuestionList.AllItems,
                        AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & If(ThisRecord.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=ThisRecord.fa_question_pos_in && fa_child_pos_in=ThisRecord.fa_child_pos_in,fa_Edit_Reason), Q99_Txt_EditReason.Text) & ""
                    ),""
                ),
                ""
            );
            //-------------------------------------------------------------------------------------------------------------------RESULTADO
            Switch(
                First(varResponse).ResponseID,
                100,
            //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                If(
                    (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
            //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ) ,
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" &
                                Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                     ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                );
                //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                If(
                    varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                    //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ) ,
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name  & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                );
               If(CountRows(colBlobMedia)>=1,
                Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
              
            
                //-------------------------------------------------------Notifica en pantalla
            Notify(
                    First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                    NotificationType.Success,1500
                );
                ,
                200,
                Notify(
                    "System error! Please try again",
                    NotificationType.Error
                ),//------------------------------------------Cambiar mensaje
                Notify(
                    "Please try again!",
                    NotificationType.Warning
                )//-----------------------------------------------------------Cambiar mensaje
            );
             UpdateContext({Pr_PartialRecord: 1});
            UpdateContext({varLoadingVisible: false});
            Set(varBackPopup,false);
            //UpdateContext({VarTimerStart:true});
            If(AutoSave,
            Set(AutoSave,false);
            Set(AutoSave,true),Set(AutoSave,true);
            Set(AutoSave,false))
        Reset: =varTimerReset
        Start: |+
            =!VarSavedTemplate && Pr_ReviewMode <> 1 && AutoSave && !(Formularios_Loading_Cmp_Loading.IsLoading)
            
        Visible: =false
        Width: =83
        X: =112
        Y: =27
        ZIndex: =38

    Tmr_GalRedesign As timer:
        AutoStart: =loopcompleted<>true
        Duration: =1
        Height: =34
        OnTimerEnd: |
            =If(!IsBlank(LookUp(coltestanswere ,fa_answer_type_in=0 )),
            If(App.Width>=1229 && App.Width<=2650,
            
            If(loopcompleted<>true,
            ClearCollect(coltestanswere1,LookUp(coltestanswere ,fa_answer_type_in=0 And Mod(questionNumberNew,2)=0));
            Collect(coltestanswere,{questionNumberNew: First(coltestanswere1).questionNumberNew });
            
            ForAll(Filter(coltestanswere ,questionNumberNew>=First(coltestanswere1).questionNumberNew &&!IsBlank(RowNum)) As New,
            UpdateIf(coltestanswere,questionNumberNew=New.questionNumberNew && RowNum = New.RowNum ,{questionNumberNew: New.questionNumberNew+1}));
            If(IsBlank(LookUp(coltestanswere ,fa_answer_type_in=0 And Mod(questionNumberNew,2)=0).questionNumberNew),Set(loopcompleted,true),Set(loopcompleted,false))),
            App.Width>2650,
            If(loopcompleted<>true,
            ClearCollect(coltestanswere1,LookUp(coltestanswere ,fa_answer_type_in=0 And RowNum<>1  And (questionNumberNew=2 || Mod(questionNumberNew,3)=2 ||Mod(questionNumberNew,3)=0)));
            If(Mod(First(coltestanswere1).questionNumberNew,3)=0 ,
            
            Collect(coltestanswere,{questionNumberNew: First(coltestanswere1).questionNumberNew });
            
            ForAll(Filter(coltestanswere ,questionNumberNew>=First(coltestanswere1).questionNumberNew &&!IsBlank(RowNum)) As New,
            UpdateIf(coltestanswere,questionNumberNew=New.questionNumberNew && RowNum = New.RowNum ,{questionNumberNew: New.questionNumberNew+1})),
            
            //if it's in the center then add two empty rows
            
            Mod(First(coltestanswere1).questionNumberNew,3)=2 || First(coltestanswere1).questionNumberNew=2,
            
            Collect(coltestanswere,{questionNumberNew: First(coltestanswere1).questionNumberNew });
            Collect(coltestanswere,{questionNumberNew: First(coltestanswere1).questionNumberNew+1 });
            
            ForAll(Filter(coltestanswere ,questionNumberNew>=First(coltestanswere1).questionNumberNew &&!IsBlank(RowNum)) As New,
            UpdateIf(coltestanswere,questionNumberNew=New.questionNumberNew && RowNum = New.RowNum ,{questionNumberNew: New.questionNumberNew+2})) );
            If(IsBlank(LookUp(coltestanswere ,fa_answer_type_in=0 And (Mod(questionNumberNew,2)=0 || Mod(questionNumberNew,2)=1 ||Mod(questionNumberNew,3)=0) And Mod(questionNumberNew,3)<>1).questionNumberNew),Set(loopcompleted,true),Set(loopcompleted,false)
            ))
            ))
        Repeat: =loopcompleted<>true
        Visible: =false
        Width: =32
        X: =608
        ZIndex: =47

    Container3_1 As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(0,0,0,0.4)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: =varSBPopup
        Width: =App.Width
        ZIndex: =48

        Container4_1 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderThickness: =1
            DropShadow: =DropShadow.Semibold
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =550
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =112
            LayoutMinWidth: =200
            LayoutMode: =LayoutMode.Auto
            Width: =If(App.Width<=700,600,App.Width>700 &&App.Width<=1200,700,App.Width>1200,1000)
            ZIndex: =1

            Icon2_1 As icon.CancelBadge:
                AlignInContainer: =AlignInContainer.End
                Color: =RGBA(255, 0, 0, 0.59)
                Height: =70
                Icon: =Icon.CancelBadge
                OnSelect: |-
                    =UpdateContext({varSBPopup:false})
                PaddingRight: =10
                PaddingTop: =10
                Width: =60
                ZIndex: =1

            Container5_1 As groupContainer.horizontalAutoLayoutContainer:
                Height: =225
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =112
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                Label9_1 As label:
                    Align: =Align.Center
                    AlignInContainer: =AlignInContainer.Center
                    FontWeight: =FontWeight.Semibold
                    Height: =70
                    LayoutMinHeight: =70
                    LayoutMinWidth: =560
                    Size: =18
                    Text: ="Please select the user level to send back"
                    Width: =560
                    ZIndex: =1

                Container8 As groupContainer.manualLayoutContainer:
                    Height: =225
                    LayoutMinHeight: =112
                    LayoutMinWidth: =250
                    ZIndex: =2

                    txt_reason_sendBack As text:
                        Default: =
                        Height: =112
                        HintText: ="Describe the reason of send back"
                        Mode: =TextMode.MultiLine
                        Size: =18
                        Width: =cmb_sendback_level.Width
                        X: =(Parent.Width-Self.Width)/2
                        Y: =81
                        ZIndex: =1

                    lbl_reason_SB As label:
                        Color: =RGBA(26, 26, 26, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =70
                        PaddingLeft: =15
                        Size: =18
                        Text: ="Reason"
                        Width: =125
                        X: =txt_reason_sendBack.X-Self.Width
                        Y: =102
                        ZIndex: =2

                    cmb_sendback_level As combobox:
                        BorderColor: |-
                            =ColorValue("#3BA5A8")
                        ChevronBackground: |-
                            =ColorValue("#3BA5A8")
                        ChevronHoverBackground: |-
                            =ColorFade(ColorValue("#3BA5A8"), -20%)
                        DisplayFields: =["Value"]
                        IsSearchable: =false
                        Items: |
                            =If(!IsHRecord,
                                ForAll(Sequence(First(coltestanswere).fa_active_level-1,1,1),Concatenate("User Level ",ThisRecord.Value)),
                                ForAll(Sequence(First(coltestanswere).fa_total_question_level,1,1),Concatenate("User Level ",ThisRecord.Value)))
                        PressedFill: |-
                            =ColorValue("#3BA5B9")
                        SearchFields: =["Value"]
                        SearchItems: =[]
                        SelectionColor: =Color.Black
                        SelectionFill: |-
                            =ColorValue("#3BA5A8")
                        SelectMultiple: =false
                        Size: =18
                        Width: =350
                        X: =(Parent.Width-Self.Width)/2
                        Y: =10
                        ZIndex: =3

                    lbl_reason_SB_1 As label:
                        Color: =RGBA(26, 26, 26, 1)
                        FontWeight: =FontWeight.Semibold
                        Height: =39
                        PaddingLeft: =15
                        PaddingRight: =20
                        Size: =18
                        Text: ="Level"
                        Width: =125
                        X: =txt_reason_sendBack.X-Self.Width
                        Y: =11
                        ZIndex: =4

                Container7_1 As groupContainer.horizontalAutoLayoutContainer:
                    Height: =225
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =30
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =112
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =5

                    btn_popup_send_back_2 As button:
                        DisplayMode: =If(!IsBlank(cmb_sendback_level.Selected) && Len(Trim(txt_reason_sendBack.Text))>=10,DisplayMode.Edit,DisplayMode.Disabled)
                        Fill: |-
                            =ColorValue("#3BA5A8")
                        Height: =50
                        HoverFill: |-
                            =ColorFade(ColorValue("#3BA5A8"), -20%)
                        LayoutMinHeight: =70
                        LayoutMinWidth: =280
                        OnSelect: |
                            =UpdateContext({varActiveLevel: First(collAnswers).fa_active_level});
                            UpdateContext({varLastLevel: First(collAnswers).fa_total_question_level});
                            UpdateContext({varLoadingVisible: true});
                            UpdateContext({vasStartTimerEvaluate: true});
                            If(Value(Mid( cmb_sendback_level.Selected.Value,12))=1,
                            UpdateContext({varLevel1User:
                            dsf_get_level1_user_details.Run(varPlantId,Pr_FormNumber,Pr_DateFilteDT)}));
                                
                                
                                UpdateContext(
                                {
                                    varFrequecyType: First(
                                        Filter(
                                            'dsf.form_library_counters',
                                            fl_plant_id_in = varPlantId,
                                            fl_form_number_vc = Pr_FormNumber
                                        )
                                    ).fl_frequency_vc
                                }
                            );
                            UpdateContext(
                                {
                                    varPO: " - PO: " & Text(
                                        First(
                                            Filter(
                                                Formularios_QuestionList.AllItems,
                                                AnsPos.Text = "1"
                                            )
                                        ).Debug_Lbl_Answer.Text
                                    )
                                }
                            );
                            UpdateContext(
                                {
                                    varCIPObject: " - CIP Object: (" & Text(
                                        First(
                                            Filter(
                                                Formularios_QuestionList.AllItems,
                                                AnsPos.Text = "2"
                                            )
                                        ).Debug_Lbl_Answer.Text
                                    ) & ") " & Text(
                                        First(
                                            Filter(
                                                Formularios_QuestionList.AllItems,
                                                AnsPos.Text = "3"
                                            )
                                        ).Debug_Lbl_Answer.Text
                                    )
                                }
                            );
                            UpdateContext(
                                {
                                    varMicroObject: " - CIP Object: (" & Text(
                                        First(
                                            Filter(
                                                Formularios_QuestionList.AllItems,
                                                AnsPos.Text = "3"
                                            )
                                        ).Debug_Lbl_Answer.Text
                                    ) & ") " & Text(
                                        First(
                                            Filter(
                                                Formularios_QuestionList.AllItems,
                                                AnsPos.Text = "4"
                                            )
                                        ).Debug_Lbl_Answer.Text
                                    )
                                }
                            );
                            //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
                            Clear(varResponse);
                            ClearCollect(
                                varResponse,
                                 'dsf.send_back'.Run(varFormNum,
                                    Pr_DateFilteDT,
                                    Text(
                                        Now(),
                                        "[$-es-ES]yyyy/mm/dd hh:mm:ss"
                                    ),varActiveLevel,Mid(
                                        cmb_sendback_level.Selected.Value,
                                        11
                                    ),txt_reason_sendBack.Text,varUserId,varUserEmail));
                                
                            //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
                            If(
                                varDebugBit = 1 And !IsBlank(varDebugEmail),
                                Send_Team_Messagev2.Run(
                                    varDebugEmail,
                                    "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " & Concat(
                                        Formularios_QuestionList.AllItems,
                                        AnsPos.Text & "" & Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & Q99_Txt_EditReason.Text & ""
                                    ),""
                                ),
                                ""
                            );
                            //-------------------------------------------------------------------------------------------------------------------RESULTADO
                            Switch(
                                First(varResponse).ResponseID,
                                100,
                               
                                //-------------------------------------------------------Busca los usuarios a notificar
                                If( Value(Mid( cmb_sendback_level.Selected.Value,12))<>1,
                                UpdateContext(
                                    {
                                        varUserEmails: LookUp(
                                            'dsf.form_level_desc',
                                            nu_form_number_vc = Pr_FormNumber And nu_plant_id_in = varPlantId And nu_user_level = Value(
                                                Mid(
                                                    cmb_sendback_level.Selected.Value,
                                                    12
                                                )
                                            )
                                        ).nu_users_email_tx
                                    }
                                ),UpdateContext(
                                        {
                                            varUserEmails: LookUp(
                                    'users.users',
                                 usr_id_bin=
                            First(varLevel1User).sf_user_id_bin).usr_email_vc
                                        }
                                    ););
                                //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                            If(
                                    (varFormType = 1 Or varFormType = 2),
                            //------------------------------------------------------- Almacena los archivos adjuntos
                            //-------------------------------------------------------Enva los Teams a cada usuario
                                  
                                    If(
                                        !IsBlank(varUserEmails),
                                        Send_Team_Messagev2.Run(
                                            varUserEmails,
                                         "<p style=""color: red""><b style=""font-weight: 600;""> Request Sent Back</b></p>" & "<br> " &
                                         "<b style=""font-weight: 600;"">Document Number:</b> "&Pr_FormNumber&"" &"<br>"&
                                          "<b style=""font-weight: 600;"">Document Name:</b> "&""&Pr_FormDescription&"" &   "<br>"&
                                          If(
                                                varFrequecyType = "<br>PO",
                                                varPO,
                                                If(
                                                    "25975.2" in Pr_FormNumber,
                                                    varMicroObject,
                                                    If(
                                                        "26874.1" in Pr_FormNumber,
                                                        varCIPObject,
                                                        ""
                                                    )
                                                )
                                            )&
                                        "<b style=""font-weight: 600;"">Sent Back by: </b>" & " " & User().FullName &"<br><br>"&
                                         "<b style=""font-weight: 600;"">Reason: </b><b style=""font-weight: 400;"">" &txt_reason_sendBack.Text &".</b> " 
                                         &"<br><br> Please visit " & "<a href='"&LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId,cnf_mobile_app_link)&"&screen=form&FN="&Pr_FormNumber&"&RD="&Pr_DateFilterIn&"'>Digital Standard Forms</a>"&" to access the request."
                                    ,""
                                           
                                        )
                                    );
                                );
                               
                                Back(ScreenTransition.Fade);
                                //-------------------------------------------------------Notifica en pantalla
                            Notify(
                                    First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & "successfully send back",
                                    NotificationType.Success
                                );
                                ,
                                200,
                                Notify(
                                    "System error! Please try again",
                                    NotificationType.Error
                                ),//------------------------------------------Cambiar mensaje
                                Notify(
                                    "Please try again!",
                                    NotificationType.Warning
                                )//-----------------------------------------------------------Cambiar mensaje
                            );
                            UpdateContext({varSBPopup: false});
                            UpdateContext({varLoadingVisible: false});
                        RadiusBottomLeft: =12
                        RadiusBottomRight: =12
                        RadiusTopLeft: =12
                        RadiusTopRight: =12
                        Size: =18
                        Text: ="Send Back"
                        Width: =180
                        ZIndex: =1

                    btn_popup_send_back_3 As button:
                        Fill: |-
                            =ColorValue("#3BA5A8")
                        Height: =50
                        HoverFill: |-
                            =ColorFade(ColorValue("#3BA5A8"), -20%)
                        LayoutMinHeight: =70
                        LayoutMinWidth: =280
                        OnSelect: |-
                            =UpdateContext({varSBPopup:false})
                        RadiusBottomLeft: =12
                        RadiusBottomRight: =12
                        RadiusTopLeft: =12
                        RadiusTopRight: =12
                        Size: =18
                        Text: ="Cancel"
                        Width: =180
                        ZIndex: =2

    Formularios_CloseMessage_1 As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =49

        Formularios_CloseMessage_Shp_Background_1 As rectangle:
            DisabledFill: =Formularios_CloseMessage_Shp_Background_1.Fill
            Fill: =RGBA(96, 96, 98, 0.64)
            FocusedBorderColor: =Formularios_CloseMessage_Shp_Background_1.BorderColor
            Height: =Parent.Height
            HoverFill: =Formularios_CloseMessage_Shp_Background_1.Fill
            OnSelect: =
            PressedFill: =Formularios_CloseMessage_Shp_Background_1.Fill
            Visible: =varConfirmPopup
            Width: =Parent.Width
            ZIndex: =39

        Formularios_CloseMessage_Shp_BackgroundMessage_1 As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: |
                =Formularios_CloseMessage_Shp_Accept_1.Y + Formularios_CloseMessage_Shp_Accept_1.Height - Self.Y + 30
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:1;background-color:#FFFFFF;box-shadow:0 3px 6px 1px  #ccc; border-radius:8px'></div>"
            Visible: =varConfirmPopup
            Width: =Parent.Width * 0.9
            X: =(Parent.Width - Self.Width)/2
            Y: =Parent.Height/2 - 300
            ZIndex: =40

        Formularios_CloseMessage_Shp_Accept_1 As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =90
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:0.8;background-color:#F0F0F0;box-shadow:0 3px 6px 1px  #ccc; border-radius:90px'></div>"
            OnSelect: =
            Visible: =varConfirmPopup
            Width: =(Formularios_CloseMessage_Shp_BackgroundMessage_1.Width/2) *0.8
            X: =Accion_AcquireForm_Lbl_AcquireMessage.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription_1.Y + Formularios_CloseMessage_Lbl_CloseDescription_1.Height + 15 
            ZIndex: =41

        Formularios_CloseMessage_Shp_Cancel_1 As htmlViewer:
            Fill: =RGBA(0, 0, 0, 0)
            Height: =90
            HtmlText: |-
                ="<div style='margin:10px;width: " & Self.Width - 32 & "px;height:" & Self.Height - 35 & "px;opacity:0.8;background-color:#F0F0F0;box-shadow:0 3px 6px 1px  #ccc; border-radius:90px'></div>"
            OnSelect: =
            Visible: =varConfirmPopup
            Width: =(Formularios_CloseMessage_Shp_BackgroundMessage_1.Width/2) *0.8
            X: =Accion_AcquireForm_Lbl_AcquireMessage.X + Accion_AcquireForm_Lbl_AcquireMessage.Width - Self.Width
            Y: =Formularios_CloseMessage_Lbl_CloseDescription_1.Y + Formularios_CloseMessage_Lbl_CloseDescription_1.Height + 15 
            ZIndex: =42

        Formularios_CloseMessage_Btn_Cancel_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(40, 60, 97, 1)
            Font: ="U"
            Height: =Formularios_CloseMessage_Shp_Cancel_1.Height
            OnSelect: |
                =UpdateContext({varConfirmPopup: false});
                Set(AutoSave,false);
                Set(AutoSave,true);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =20
            Text: =First(collAppLanguage).'Question Cancel Button Screen 6'
            Visible: =varConfirmPopup
            Width: =Formularios_CloseMessage_Shp_Cancel_1.Width
            X: =Formularios_CloseMessage_Shp_Cancel_1.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription_1.Y + Formularios_CloseMessage_Lbl_CloseDescription_1.Height + 15 
            ZIndex: =43

        Formularios_CloseMessage_Btn_Accept_1 As label:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            Color: =RGBA(40, 60, 97, 1)
            Font: ="U"
            Height: =Formularios_CloseMessage_Shp_Accept_1.Height
            OnSelect: |+
                =If(varSaveType="Final",
                UpdateContext({varLoadingVisible: true});
                UpdateContext({vasStartTimerEvaluate: true});
                UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
                UpdateContext({varPO: " - PO: " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer.Text)});
                UpdateContext({varCIPObject: " - CIP Object: (" & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "2")).Debug_Lbl_Answer.Text) & ") " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "3")).Debug_Lbl_Answer.Text)});
                UpdateContext({varMicroObject: " - CIP Object: (" & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "3")).Debug_Lbl_Answer.Text) & ") " & Text(First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "4")).Debug_Lbl_Answer.Text)});
                
                //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
                Clear(varResponse);
                Clear(colBlobMedia);
                ClearCollect(
                    varResponse,
                    fa_AnswerReport_Opt.Run(
                        varUserEmail,
                         Concat(
                           Formularios_QuestionList.AllItems As Item ,
                            Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                        ),
                        varFormNum,
                        Pr_DateFilteDT,
                        1,
                        If(varUserEmisorReceptor,1,0),
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),If(varFormType = 2,First(coltestanswere).fa_active_level+1,1),If(varFormType = 2,First(coltestanswere).fa_total_question_level,1)
                    )
                );
                //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
                If(
                    varDebugBit = 1 And !IsBlank(varDebugEmail),
                    Send_Team_Messagev2.Run(
                        varDebugEmail,
                        "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " & Concat(
                           Formularios_QuestionList.AllItems,
                            AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & If(ThisRecord.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=ThisRecord.fa_question_pos_in && fa_child_pos_in=ThisRecord.fa_child_pos_in,fa_Edit_Reason), Q99_Txt_EditReason.Text) & ""
                        ),""
                    ),
                    ""
                );
                //-------------------------------------------------------------------------------------------------------------------RESULTADO
                Switch(
                    First(varResponse).ResponseID,
                    100,
                    //-------------------------------------------------------Busca los usuarios a notificar
                    UpdateContext(
                        {
                            varUserEmails: LookUp(
                                'dsf.form_level_desc',
                                nu_form_number_vc = Pr_FormNumber And nu_plant_id_in = varPlantId And nu_user_level=varActiveLevel+1
                            ).nu_users_email_tx
                        }
                    );
                    //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                If(
                        (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
                //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & 
                                    Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                         ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss")  & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        ));
                        //-------------------------------------------------------Enva los Teams a cada usuario
                        /*If(!IsBlank(varUserEmail),Send_Team_Messagev2.Run(varUserEmail,First(collAppLanguage).Btn_RightButton_06_MSG04 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG05 & " " & User().FullName & If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))),"")));*/
                
                         If(varFormType = 2 And (IsBlank(varIsFormRequest.fr_status_in) || (Len(varIsFormRequest.fr_status_in)<1) || varIsFormRequest.fr_status_in=-1),
                           Send_Team_Messagev2.Run(
                            varUserEmails,
                            
                            " The form has been submitted,"&"<br><br>"& 
                            "<b style=""font-weight: 600;"">Document Number:</b> "&Pr_FormNumber&"" &"<br>"&
                            "<b  style=""font-weight: 600;"">Document Name:</b> "&""&Pr_FormDescription&"" &   
                            If(varFrequecyType = "PO",  "<br><b style=""font-weight: 600;"">"&Substitute(varPO,"-","")&"</b>",If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))) & "<br>"&
                            "<b style=""font-weight: 600;"">Submitted by: </b>" & " " & User().FullName &
                           "<br><br> and is now available for you at <b style=""font-weight: 600;"">Level-"&varActiveLevel+1&"</b>.<br><br> Please visit " & "<a href='"&LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId,cnf_mobile_app_link)&"&screen=form&FN="&Pr_FormNumber&"&RD="&Pr_DateFilterIn&"'>Digital Standard Forms</a>"&" to access the request."
                        ,""));
                   
                    //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                If(
                        varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                        //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        );
                        //-------------------------------------------------------Busca quien creo el request (Emisor)
                UpdateContext(
                            {
                                varOwnerRequest: LookUp(
                                    'dsf.form_request_report',
                                    fr_form_number_vc = Pr_FormNumber And fr_planta_id_in = varPlantId And fr_reportdate_dt = Pr_DateFilteDT
                                ).createdby_email
                            }
                        );
                UpdateContext(
                            {
                                varOwnerDisplayNameRequest: LookUp(
                                    'dsf.form_request_report',
                                    fr_form_number_vc = Pr_FormNumber And fr_planta_id_in = varPlantId And fr_reportdate_dt = Pr_DateFilteDT
                                ).createdby_dispname
                            }
                        );
                        //-------------------------------------------------------Enva los Teams a todas las partes (Usuarios a notificar) 
                        If(!IsBlank(varUserEmails), If( varActiveLevel=varLastLevel,
                Send_Team_Messagev2.Run(
                            varUserEmails,
                            First(collAppLanguage).Btn_RightButton_06_MSG01 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG02 & " " & varOwnerDisplayNameRequest & " " & First(collAppLanguage).Btn_RightButton_06_MSG03 & " " & User().FullName &        
                            If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,"")))
                        ,""),   Send_Team_Messagev2.Run(
                            varUserEmails,
                            
                            " The form has been submitted,"&"<br><br>"& 
                            "<b style=""font-weight: 600;"">Document Number:</b> "&Pr_FormNumber&"" &"<br>"&
                            "<b  style=""font-weight: 600;"">Document Name:</b> "&""&Pr_FormDescription&"" &   
                            If(varFrequecyType = "PO",  "<br><b style=""font-weight: 600;"">"&Substitute(varPO,"-","")&"</b>",If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,""))) & "<br>"&
                            "<b style=""font-weight: 600;"">Submitted by: </b>" & " " & User().FullName &
                            "<br><br> and is now available for you at <b style=""font-weight: 600;"">Level-"&varActiveLevel+1&"</b>.<br><br> Please visit " & "<a href='"&LookUp('dsf.plant_configuration',cnf_plant_id_in=varPlantId,cnf_mobile_app_link)&"&screen=form&FN="&Pr_FormNumber&"&RD="&Pr_DateFilterIn&"'>Digital Standard Forms</a>"&" to access the request."
                        ,"")));
                        //-------------------------------------------------------Enva el Teams a la persona que creo el request
                        If(!IsBlank(varOwnerRequest) And varActiveLevel=varLastLevel && varUserEmail<>varOwnerRequest,
                Send_Team_Messagev2.Run(
                            varOwnerRequest,
                            First(collAppLanguage).Btn_RightButton_06_MSG01 & " " & Pr_FormNumber & " " & First(collAppLanguage).Btn_RightButton_06_MSG02 & " " & varOwnerDisplayNameRequest & " " & First(collAppLanguage).Btn_RightButton_06_MSG03 & " " & User().FullName &        
                            If(varFrequecyType = "PO", varPO,If("25975.2" in Pr_FormNumber,varMicroObject,If("26874.1" in Pr_FormNumber,varCIPObject,"")))
                        ,""));
                    );
                    //-------------------------------------------------------Navega a la ventana principal
                fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        "",
                        varFormNum,
                        Pr_DateFilteDT,
                        99,
                        0,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                    );
                    //--------Save Blob Path in SQL DSF_Form_Attachment Table-----------------------------------------
                    If(CountRows(colBlobMedia)>=1,
                    Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
                    If(CountRows(varResponseSAS)>=1,
                    Back(
                        ScreenTransition.Fade
                    ),
                Back(
                        ScreenTransition.Fade
                    ));
                    
                    //-------------------------------------------------------Notifica en pantalla
                Notify(
                        First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                        NotificationType.Success
                    );
                    ,
                    200,
                    Notify("System error! Please try again",NotificationType.Error),//------------------------------------------Cambiar mensaje
                    Notify("Please try again!",NotificationType.Warning)//-----------------------------------------------------------Cambiar mensaje
                );
                UpdateContext({varLoadingVisible: false});
                
                UpdateContext({varConfirmPopup: false});
                ,
                UpdateContext({varLoadingVisible: true});
                UpdateContext({vasStartTimerEvaluate: true});
                //UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
                //UpdateContext({varPO: First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer});
                
                //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
                Clear(varResponse);
                Clear(colBlobMedia);
                ClearCollect(
                    varResponse,
                    fa_AnswerReport_Opt.Run(
                        varUserEmail,
                        Concat(
                           Formularios_QuestionList.AllItems As Item ,
                            Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                        ),
                        varFormNum,
                        Pr_DateFilteDT,
                        0,//paramFormType,
                        If(
                            varUserEmisorReceptor,
                            1,
                            0
                        ),
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),If(varFormType = 2,First(coltestanswere).fa_active_level,1),If(varFormType = 2,First(coltestanswere).fa_total_question_level,1)
                ));
                //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
                If(
                    varDebugBit = 1 And !IsBlank(varDebugEmail),
                    Send_Team_Messagev2.Run(
                        varDebugEmail,
                        "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " & Concat(
                           Formularios_QuestionList.AllItems,
                            AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & If(ThisRecord.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=ThisRecord.fa_question_pos_in && fa_child_pos_in=ThisRecord.fa_child_pos_in,fa_Edit_Reason), Q99_Txt_EditReason.Text) & ""
                        ),""
                    ),
                    ""
                );
                //-------------------------------------------------------------------------------------------------------------------RESULTADO
                Switch(
                    First(varResponse).ResponseID,
                    100,
                //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                    If(
                        (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
                //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ) ,
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                Collect(colBlobMedia,
                                AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" &
                                    Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                         ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 01"
                            ),
                            
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        );
                    );
                    //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                    If(
                        varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                        //------------------------------------------------------- Almacena los archivos adjuntos
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "14",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ) ,
                            ForAll(
                                Q14_QuestionAttachment.Attachments,
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                    ThisRecord.Value
                                ))
                            )
                        );
                        
                //------------------------------------------------------- Almacena los imagenes capturadas
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "11",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                            ForAll(
                                Q11_QuestionCamera_Lst_Gallery.AllItems,
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                    ThisRecord.Q11_QuestionCamera_Img_Image.Image
                                ))
                            )
                        );
                        ForAll(
                            Filter(
                                Formularios_QuestionList.AllItems,
                                Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                                Debug_Lbl_UserType.Text = "User type: User 02"
                            ),
                                 Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                    BlobPathGemba,
                                    Pr_FormNumber & "" & Substitute( 
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Substitute(
                                                        Pr_DateFilteDT,
                                                        "/",
                                                        ""
                                                    ),
                                                    ":",
                                                    ""
                                                ),
                                                " ",
                                                ""
                                            ),
                                            "-",
                                            ""
                                        ),
                                        "T",
                                        ""
                                    ) & "" & AnsPos.Text & "" & 
                                    "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                    Q15_Signature_PenInput.Image
                                ))
                            
                        );
                    );
                    //--------Save Blob Path in SQL DSF_Form_Attachment Table-----------------------------------------
                   If(CountRows(colBlobMedia)>=1,
                    Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
                    If(CountRows(varResponseSAS)>=1,
                    Back(
                        ScreenTransition.Fade
                    ),
                    
                    //-------------------------------------------------------Navega a la ventana principal
                Back(
                        ScreenTransition.Fade
                    ));
                
                    //-------------------------------------------------------Notifica en pantalla
                Notify(
                        First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                        NotificationType.Success
                    );
                    ,
                    200,
                    Notify(
                        "System error! Please try again",
                        NotificationType.Error
                    ),//------------------------------------------Cambiar mensaje
                    Notify(
                        "Please try again!",
                        NotificationType.Warning
                    )//-----------------------------------------------------------Cambiar mensaje
                );
                UpdateContext({varLoadingVisible: false});
                UpdateContext({varConfirmPopup: false});
                )
                
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =20
            Text: =First(collAppLanguage).Btn_LeftBtn_1
            Visible: =varConfirmPopup
            Width: =Formularios_CloseMessage_Shp_Accept_1.Width
            X: =Formularios_CloseMessage_Shp_Accept_1.X
            Y: =Formularios_CloseMessage_Lbl_CloseDescription_1.Y + Formularios_CloseMessage_Lbl_CloseDescription_1.Height + 15 
            ZIndex: =44

        Formularios_CloseMessage_Lbl_CloseDescription_1 As label:
            Align: =Align.Center
            AutoHeight: =true
            Color: =RGBA(255, 0, 0, 1)
            FocusedBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription_1.BorderColor
            Font: ="Unity"
            FontWeight: =FontWeight.Semibold
            Height: =174
            HoverBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription_1.BorderColor
            HoverColor: =Formularios_CloseMessage_Lbl_CloseDescription_1.Color
            HoverFill: =Formularios_CloseMessage_Lbl_CloseDescription_1.Fill
            OnSelect: =
            PressedBorderColor: =Formularios_CloseMessage_Lbl_CloseDescription_1.BorderColor
            PressedColor: =Formularios_CloseMessage_Lbl_CloseDescription_1.Color
            PressedFill: =Formularios_CloseMessage_Lbl_CloseDescription_1.Fill
            Size: =21
            Text: |-
                =
                "Question (" & Concat(colOutofRange, Question ,  ",")& ") " & If(CountRows(colOutofRange) > 1, "are", "is") & " out of the defined range"
                
                //"Question ("&Concat(colOutofRange,Question,",")&") "&If(CountRows(colOutofRange)>1,"are","is")&" out of defined Range"
            VerticalAlign: =VerticalAlign.Top
            Visible: =varConfirmPopup
            Width: =Formularios_CloseMessage_Shp_BackgroundMessage_1.Width * 0.9
            X: =(Parent.Width-Formularios_CloseMessage_Lbl_CloseDescription_1.Width)/2
            Y: =Formularios_SaveMessage_Lbl_SaveTitle.Y + Formularios_SaveMessage_Lbl_SaveTitle.Height + 15
            ZIndex: =45

        Formularios_SaveMessage_Lbl_SaveTitle As label:
            Align: =Align.Center
            AutoHeight: =true
            FocusedBorderColor: =Formularios_SaveMessage_Lbl_SaveTitle.BorderColor
            Font: =
            FontWeight: =FontWeight.Bold
            Height: =44
            HoverBorderColor: =Formularios_SaveMessage_Lbl_SaveTitle.BorderColor
            HoverColor: =Formularios_SaveMessage_Lbl_SaveTitle.Color
            HoverFill: =Formularios_SaveMessage_Lbl_SaveTitle.Fill
            OnSelect: =
            PressedBorderColor: =Formularios_SaveMessage_Lbl_SaveTitle.BorderColor
            PressedColor: =Formularios_SaveMessage_Lbl_SaveTitle.Color
            PressedFill: =Formularios_SaveMessage_Lbl_SaveTitle.Fill
            Size: =30
            Text: ="Do you really want to"&If(varSaveType="Partial"," partially","")&" save? "
            Visible: =varConfirmPopup
            Width: =Formularios_CloseMessage_Shp_BackgroundMessage_1.Width * 0.9
            X: =Formularios_CloseMessage_Shp_Accept_1.X
            Y: =Formularios_CloseMessage_Shp_BackgroundMessage_1.Y + 25
            ZIndex: =46

    lbl_calculated_height As label:
        Fill: =RGBA(241, 244, 249, 1)
        Height: =43
        Size: =21
        Text: =Max(Formularios_QuestionList.AllItems,Label15.Text)
        Visible: =false
        Width: =250
        X: =370
        Y: =120
        ZIndex: =57

    btn_auto_save As button:
        Height: =44
        OnSelect: |+
            =
            
            UpdateContext({varLoadingVisible: true});
            
            Set(varTimerReset,true);
            Set(varTimerReset,false);
            UpdateContext({vasStartTimerEvaluate: true});
            //UpdateContext({varFrequecyType: First(Filter('dsf.form_library_counters',fl_plant_id_in = varPlantId,fl_form_number_vc = Pr_FormNumber)).fl_frequency_vc});
            //UpdateContext({varPO: First(Filter(Formularios_QuestionList.AllItems,AnsPos.Text = "1")).Debug_Lbl_Answer});
            
            //------------------------------------------------------------------------------------------------------------------- REGISTRA FORMULARIO
            Clear(varResponse);
            Clear(colBlobMedia);
            ClearCollect(
                varResponse,
                fa_AnswerReport_Opt.Run(
                    varUserEmail,
                    Concat(
                       Formularios_QuestionList.AllItems As Item ,
                        Item.AnsPos.Text & "" & Item.fa_child_pos_in & "" &Item.Debug_Lbl_Answer.Text & "" & Item.Q99_Txt_Notes.Text & "" & If(Item.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=Item.fa_question_pos_in&&fa_child_pos_in=Item.fa_child_pos_in,fa_Edit_Reason),Item. Q99_Txt_EditReason.Text) & ""
                    ),
                    varFormNum,
                    Pr_DateFilteDT,
                    2,//varFormType,
                    If(
                        varUserEmisorReceptor,
                        1,
                        0
                    ),
                    Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss"),First(coltestanswere).fa_active_level,First(coltestanswere).fa_total_question_level
                )
            );
             nf_Update_Form_Requestv2.Run(
                        varPlantId,
                        varFormNum,
                        Pr_DateFilteDT,
                        varUserId,
                        1,
                        Text(Now(),"[$-es-ES]yyyy/mm/dd hh:mm:ss")
                    );
            //-------------------------------------------------------Si el Debug esta activo enva mensaje a Tester
            If(
                varDebugBit = 1 And !IsBlank(varDebugEmail),
                Send_Team_Messagev2.Run(
                    varDebugEmail,
                    "DSF Mobile Debug Mode" & "<br>" & "Form Number: " & Pr_FormNumber & " User Email: " & varUserEmail & " User ID: " & varUserId & "<br>" & "Form Type: " & varFormType & " Form Stage: " & varUserEmisorReceptor & " Report Date: " & Pr_DateFilteDT & "<br>" & "Array: " &  Concat(
                       Formularios_QuestionList.AllItems,
                        AnsPos.Text & "" & ThisRecord.fa_child_pos_in & "" &Debug_Lbl_Answer.Text & "" & Q99_Txt_Notes.Text & "" & If(ThisRecord.fa_answer_type_in=13,LookUp(colTableEditReason,fa_question_pos_in=ThisRecord.fa_question_pos_in && fa_child_pos_in=ThisRecord.fa_child_pos_in,fa_Edit_Reason), Q99_Txt_EditReason.Text) & ""
                    ),""
                ),
                ""
            );
            //-------------------------------------------------------------------------------------------------------------------RESULTADO
            Switch(
                First(varResponse).ResponseID,
                100,
            //-------------------------------------------------------Formulario tipo 02 - Fin del Emisor
                If(
                    (varFormType = 1 Or varFormType = 2) And (IsBlank(varIsFormRequest.fr_status_in) Or varIsFormRequest.fr_status_in = -1),
            //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" &
                                Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                );
                 ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 01"
                        ),
                        
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                //------------------------------------------------------- Formulario tipo 02 - Fin del Receptor
                If(
                    varFormType = 2 And (varIsFormRequest.fr_status_in = 0 Or varIsFormRequest.fr_status_in = 1),
                    //------------------------------------------------------- Almacena los archivos adjuntos
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "14",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                        ForAll(
                            Q14_QuestionAttachment.Attachments,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Name & Text(Now(), "dd-mm-yyyy-hh:mm:ss"),
                                ThisRecord.Value
                            ))
                        )
                    );
                    
            //------------------------------------------------------- Almacena los imagenes capturadas
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "11",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                        ForAll(
                            Q11_QuestionCamera_Lst_Gallery.AllItems,
                            Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & ThisRecord.Q11_QuestionCamera_Lbl_Pos.Text & ".jpg",
                                ThisRecord.Q11_QuestionCamera_Img_Image.Image
                            ))
                        )
                    );
                    ForAll(
                        Filter(
                            Formularios_QuestionList.AllItems,
                            Ans_Type.Text = "15",lbl_sign_status.Text = "true",
                            Debug_Lbl_UserType.Text = "User type: User 02"
                        ),
                             Collect(colBlobMedia,AzureBlobStorage.CreateFile(
                                BlobPathGemba,
                                Pr_FormNumber & "" & Substitute( 
                                    Substitute(
                                        Substitute(
                                            Substitute(
                                                Substitute(
                                                    Pr_DateFilteDT,
                                                    "/",
                                                    ""
                                                ),
                                                ":",
                                                ""
                                            ),
                                            " ",
                                            ""
                                        ),
                                        "-",
                                        ""
                                    ),
                                    "T",
                                    ""
                                ) & "" & AnsPos.Text & "" & 
                                "" & Child_pos.Text & "" & "Signature"& Text(Now(), "dd-mm-yyyy-hh:mm:ss") & ".jpg",
                                Q15_Signature_PenInput.Image
                            ))
                        
                    );
                );
               If(CountRows(colBlobMedia)>=1,
                Set(varResponseSAS,DSF_NewSAS.Run(JSON(colBlobMedia.Path))));
              
            
                //-------------------------------------------------------Notifica en pantalla
            Notify(
                    First(collAppLanguage).Btn_RightButton_06_MSG06 & " " & Pr_FormDescription & " " & First(collAppLanguage).Btn_RightButton_06_MSG07,
                    NotificationType.Success,1500
                );
                ,
                200,
                Notify(
                    "System error! Please try again",
                    NotificationType.Error,5000
                ),//------------------------------------------Cambiar mensaje
                Notify(
                    "Please try again!",
                    NotificationType.Warning,5000
                )//-----------------------------------------------------------Cambiar mensaje
            );
             UpdateContext({Pr_PartialRecord: 1});
            UpdateContext({varLoadingVisible: false});
            Set(varBackPopup,false);
            //UpdateContext({VarTimerStart:true});
            If(AutoSave,
            Set(AutoSave,false);
            Set(AutoSave,true),Set(AutoSave,true);
            Set(AutoSave,false));
            Set(AutoSaveTable,false)
            //
            
            
        Size: =16
        Text: ="table autosave"
        Visible: =false
        Width: =194
        X: =432
        Y: =132
        ZIndex: =58

    "'tgl_hide/unhide' As toggleSwitch":
        Color: =RGBA(255, 255, 255, 1)
        FalseText: ="Active Childs"
        FontWeight: =FontWeight.Semibold
        Height: =39
        OnCheck: =
        OnUncheck: |-
            =//UpdateContext({tmrChildEnable:true})
        Size: =18
        TrueText: ="All Childs"
        Visible: =false
        Width: =62
        X: =370
        Y: =132
        ZIndex: =59

    tmr_parent_question_update As timer:
        AutoStart: =varParenttmr
        Duration: =100
        Height: =38
        OnTimerEnd: |-
            =/*ClearCollect(coltestanswere2,collAnswers);
            ForAll(collAnswers As _Record,
            Patch(coltestanswere,LookUp(coltestanswere,RowNum=_Record.RowNum,{IsActive:_Record.IsActive})))*/
        Visible: =false
        Width: =124
        X: =486
        Y: =132
        ZIndex: =62

    Tmr_sign_false_status As timer:
        Duration: =200
        Height: =60
        OnTimerEnd: |
            =
            
            
            ClearCollect(ColSignaturesStatus,ShowColumns(AddColumns(Filter(coltestanswere,fa_answer_type_in=15),hasSigned,false),fa_question_pos_in,fa_child_pos_in,hasSigned));
            Reset(Q15_Signature_PenInput);
            /*
            ClearCollect(ColSignatures,ShowColumns(AddColumns(Filter(coltestanswere,fa_answer_type_in=15),InitialImage,""),fa_question_pos_in,fa_child_pos_in,InitialImage));
            /*
            If(AutoSaveTable,ForAll(Filter(Formularios_QuestionList.AllItems,fa_answer_type_in=15 And fa_question_required_bt=true)  As _Record,UpdateIf(ColSignatures,fa_question_pos_in=_Record.fa_question_pos_in && fa_child_pos_in=_Record.fa_child_pos_in,{InitialImage:_Record.Q15_Signature_PenInput.Image}));Set(AutoSaveTable,false);)
            */
        Start: =(VarLoadPage ) && ( !varLoadingVisible) && CountRows(Formularios_QuestionList.AllItems)>=1
        Visible: =false
        Width: =104
        X: =283
        Y: =46
        ZIndex: =64

    Container3 As groupContainer.manualLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.6)
        Height: =Parent.Height
        Visible: =varImageBigScale
        Width: =Parent.Width
        ZIndex: =65

        Container10 As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.Regular
            Fill: =RGBA(237, 237, 237, 1)
            Height: =Parent.Height-Self.Y
            Width: =Parent.Width
            Y: =200
            ZIndex: =1

            Gallery3 As gallery.galleryVertical:
                Default: =LookUp(varThisItemImages,Id=varPictureNumber)
                DelayItemLoading: =true
                Height: =Parent.Height-Self.Y
                Items: =varThisItemImages
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplateSize: =Parent.Height-100
                Width: =Parent.Width
                Y: =100
                ZIndex: =2

                Container11 As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.Bold
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Parent.Height-40
                    RadiusBottomLeft: =50
                    RadiusBottomRight: =50
                    RadiusTopLeft: =50
                    RadiusTopRight: =50
                    Width: =Parent.Width-40
                    X: =20
                    Y: =20
                    ZIndex: =3

                    Image5 As image:
                        Height: =Parent.Height
                        Image: =ThisItem.Q11_QuestionCamera_Img_Image.Image
                        OnSelect: =
                        Width: =Parent.Width-40
                        X: =20
                        ZIndex: =1

            icn_cancel_ER_Popup_1 As icon.CancelBadge:
                Color: =RGBA(221, 79, 14, 1)
                Height: =70
                Icon: =Icon.CancelBadge
                OnSelect: |-
                    =UpdateContext({varImageBigScale:false})
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                Width: =70
                X: =Parent.Width-Self.Width-10
                Y: =16
                ZIndex: =3

